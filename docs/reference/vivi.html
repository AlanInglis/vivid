<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Creates a matrix displaying variable importance on the diagonal
and variable interaction on the off-diagonal."><title>vivi — vivi • vivid</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="vivi — vivi"><meta property="og:description" content="Creates a matrix displaying variable importance on the diagonal
and variable interaction on the off-diagonal."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vivid</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vividVignette.html">vivid: Variable Importance and Variable Interaction Displays</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>vivi</h1>
      
      <div class="d-none name"><code>vivi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a matrix displaying variable importance on the diagonal
and variable interaction on the off-diagonal.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vivi</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">fit</span>,</span>
<span>  <span class="va">response</span>,</span>
<span>  gridSize <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  importanceType <span class="op">=</span> <span class="st">"agnostic"</span>,</span>
<span>  nmax <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  class <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  predictFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  numPerm <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  showVimpError <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>Data frame used for fit.</p></dd>


<dt>fit</dt>
<dd><p>A supervised machine learning model, which understands condvis2::CVpredict</p></dd>


<dt>response</dt>
<dd><p>The name of the response for the fit.</p></dd>


<dt>gridSize</dt>
<dd><p>The size of the grid for evaluating the predictions.</p></dd>


<dt>importanceType</dt>
<dd><p>Used to select the importance metric. By default, an agnostic importance
measure is used. If an embedded metric is available, then setting this argument
to the importance metric will use the selected importance values in the vivid-matrix.
Please refer to the examples given for illustration.
Alternatively, set to equal "agnostic" (the default) to override embedded importance measures and
return agnostic importance values.</p></dd>


<dt>nmax</dt>
<dd><p>Maximum number of data rows to consider. Default is 500. Use all rows if NULL.</p></dd>


<dt>reorder</dt>
<dd><p>If TRUE (default) uses DendSer to reorder the matrix of interactions and variable importances.</p></dd>


<dt>class</dt>
<dd><p>Category for classification, a factor level, or a number indicating which factor level.</p></dd>


<dt>predictFun</dt>
<dd><p>Function of (fit, data) to extract numeric predictions from fit. Uses condvis2::CVpredict by default, which works for many fit classes.</p></dd>


<dt>normalized</dt>
<dd><p>Should Friedman's H-statistic be normalized or not. Default is FALSE.</p></dd>


<dt>numPerm</dt>
<dd><p>Number of permutations to perform for agnostic importance. Default is 4.</p></dd>


<dt>showVimpError</dt>
<dd><p>Logical. If TRUE, and <code>numPerm &gt; 1</code> then a tibble containing the variable names, their importance values,
and the standard error for each importance is printed to the console.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A matrix of interaction values, with importance on the diagonal.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If the argument <code>importanceType = 'agnostic'</code>, then an agnostic permutation importance (1) is calculated.
Friedman's H statistic (2) is used for measuring the interactions. This measure is based on partial dependence curves
and relates the interaction strength of a pair of variables to the total effect strength of that variable pair.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>1: Fisher A., Rudin C., Dominici F. (2018). All Models are Wrong but many are Useful: Variable Importance for Black-Box, Proprietary, or Misspecified Prediction Models, using Model Class Reliance. Arxiv.</p>
<p>2: Friedman, J. H. and Popescu, B. E. (2008). “Predictive learning via rule ensembles.” The Annals of Applied Statistics. JSTOR, 916–54.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">aq</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">vivi</span><span class="op">(</span>fit <span class="op">=</span> <span class="va">f</span>, data <span class="op">=</span> <span class="va">aq</span>, response <span class="op">=</span> <span class="st">"Ozone"</span><span class="op">)</span> <span class="co"># as expected all interactions are zero</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Agnostic variable importance method used.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating interactions...</span>
<span class="r-in"><span><span class="fu"><a href="viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="vivi-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select importance metric</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/" class="external-link">randomForest</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> randomForest 4.7-1.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Type rfNews() to see new features/changes/bug fixes.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘randomForest’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:ranger’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     importance</span>
<span class="r-in"><span><span class="va">rf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">aq</span>, importance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">vivi</span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rf1</span>, data <span class="op">=</span> <span class="va">aq</span>, response <span class="op">=</span> <span class="st">'Ozone'</span>,</span></span>
<span class="r-in"><span>           importanceType <span class="op">=</span> <span class="st">'%IncMSE'</span><span class="op">)</span> <span class="co"># select %IncMSE as the importance measure</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> %IncMSE importance selected.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating interactions...</span>
<span class="r-in"><span><span class="fu"><a href="viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="vivi-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/imbs-hl/ranger" class="external-link">ranger</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ranger/man/ranger.html" class="external-link">ranger</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, importance <span class="op">=</span> <span class="st">"impurity"</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">vivi</span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rf</span>, data <span class="op">=</span> <span class="va">iris</span>, response <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span> <span class="co"># returns agnostic importance</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Agnostic variable importance method used.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating interactions...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Petal.Length Petal.Width Sepal.Length Sepal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length    0.3295361   7.7133508   7.30913114  4.79184896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Width     7.7133508   0.2969298   7.12278705  4.65399990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Length    7.3091311   7.1227870   0.02092396  4.07978223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width     4.7918490   4.6539999   4.07978223  0.01055175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "vivid"  "matrix" "array" </span>
<span class="r-in"><span><span class="fu">vivi</span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rf</span>, data <span class="op">=</span> <span class="va">iris</span>, response <span class="op">=</span> <span class="st">"Species"</span>,</span></span>
<span class="r-in"><span>     importanceType <span class="op">=</span> <span class="st">"impurity"</span><span class="op">)</span> <span class="co"># returns selected 'impurity' importance.</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Embedded impurity variable importance method used.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating interactions...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Petal.Width Petal.Length Sepal.Length Sepal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Width    43.315055     8.234646     7.430272    4.992084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length    8.234646    42.801060     7.684842    5.125764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Length    7.430272     7.684842     8.395483    3.741357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width     4.992084     5.125764     3.741357    1.263833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "vivid"  "matrix" "array" </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Alan Inglis, Andrew Parnell, Catherine Hurley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

