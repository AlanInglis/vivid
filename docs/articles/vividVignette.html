<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="vivid">
<title>vivid: Variable Importance and Variable Interaction Displays • vivid</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="vivid: Variable Importance and Variable Interaction Displays">
<meta property="og:description" content="vivid">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vivid</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vividVignette.html">vivid: Variable Importance and Variable Interaction Displays</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>vivid: Variable Importance and Variable Interaction Displays</h1>
            
      
      
      <div class="d-none name"><code>vividVignette.Rmd</code></div>
    </div>

    
    
<!-- avoid border around images -->
<style>
img {
  border: 0;
  }
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<!-- badges: start -->
<p><img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/badge/vividLogoNew.png" width="240" height="276" align="right"><!-- badges: end --></p>
<p>Variable importance (VImp), variable interaction measures (VInt) and
partial dependence plots (PDPs) are important summaries in the
interpretation of statistical and machine learning models. In this
vignette we describe new visualization techniques for exploring these
model summaries. We construct heatmap and graph-based displays showing
variable importance and interaction jointly, which are carefully
designed to highlight important aspects of the fit. We describe a new
matrix-type layout showing all single and bivariate partial dependence
plots, and an alternative layout based on graph Eulerians focusing on
key subsets. Our new visualisations are model-agnostic and are
applicable to regression and classification supervised learning
settings. They enhance interpretation even in situations where the
number of variables is large and the interaction structure complex. Our
R package <code>vivid</code> (variable importance and variable
interaction displays) provides an implementation. When referring to VImp
and VInt together, we use the shorthand VIVI.</p>
<div class="section level3">
<h3 id="install-instructions">Install instructions<a class="anchor" aria-label="anchor" href="#install-instructions"></a>
</h3>
<p>Some of the plots used by <code>vivid</code> are built upon the
<code>zenplots</code> package which requires the <code>graph</code>
package from BioConductor. To install the <code>graph</code> and
<code>zenplots</code> packages use:</p>
<p><code>if (!requireNamespace("graph", quietly = TRUE)){</code>
<code>install.packages("BiocManager")</code>
<code>BiocManager::install("graph")</code><br><code>}</code> <code>install.packages("zenplots")</code></p>
<p>Now we can install <code>vivid</code> by using:</p>
<p><code>install.packages("vivid")</code></p>
<p>Alternatively you can install the latest development version of the
package in R with the commands:</p>
<p><code>if(!require(remotes)) install.packages('remotes')</code>
<code>remotes::install_github('AlanInglis/vividPackage')</code></p>
<p>We then load the required packages. <code>vivid</code> to create the
visualizations and some other packages to create various model fits.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://alaninglis.github.io/vivid/">vivid</a></span><span class="op">)</span> <span class="co"># for visualisations </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/" class="external-link">randomForest</a></span><span class="op">)</span> <span class="co"># for model fit</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/imbs-hl/ranger" class="external-link">ranger</a></span><span class="op">)</span>       <span class="co"># for model fit</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="section-1-data-and-model-fits">Section 1: Data and model fits<a class="anchor" aria-label="anchor" href="#section-1-data-and-model-fits"></a>
</h2>
<div class="section level3">
<h3 id="data-used-in-this-vignette">Data used in this vignette:<a class="anchor" aria-label="anchor" href="#data-used-in-this-vignette"></a>
</h3>
<p>The data used in the following examples is simulated from the
Friedman benchmark problem<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Friedman, Jerome H. (1991) Multivariate adaptive
regression splines. The Annals of Statistics 19 (1), pages 1-67.&lt;/p&gt;"><sup>1</sup></a>. This benchmark problem is commonly used
for testing purposes. The output is created according to the
equation:</p>
<center>
<span class="math display">\[y = 10 sin(π x_1 x_2) + 20 (x_3 - 0.5)^2 +
10 x_4 + 5 x_5 + e\]</span>
</center>
<p>For the following examples we set the number of features to equal 9
and the number of samples is set to 350 and fit a
<code>randomForest</code> random forest model with <span class="math inline">\(y\)</span> as the response. As the features <span class="math inline">\(x_1\)</span> to <span class="math inline">\(x_5\)</span> are the only variables in the model,
therefore <span class="math inline">\(x_6\)</span> to <span class="math inline">\(x_{9}\)</span> are noise variables. As can be seen
by the above equation, the only interaction is between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span></p>
<p>Create the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">genFriedman</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">noFeatures</span> <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        <span class="va">noSamples</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                        <span class="va">sigma</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Set Values</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">noSamples</span> <span class="co"># no of rows</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">noFeatures</span> <span class="co"># no of variables</span></span>
<span>  <span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="co"># Create matrix of values</span></span>
<span>  <span class="va">xValues</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="co"># Create matrix</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">xValues</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span> <span class="co"># Name columns</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">xValues</span><span class="op">)</span> <span class="co"># Create dataframe</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="co"># Equation:</span></span>
<span>  <span class="co"># y = 10sin(πx1x2) + 20(x3−0.5)^2 + 10x4 + 5x5 + ε</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">pi</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x1</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">20</span> <span class="op">*</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x3</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">10</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x4</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span>    <span class="va">df</span><span class="op">$</span><span class="va">x5</span> <span class="op">+</span> <span class="va">e</span><span class="op">)</span></span>
<span>  <span class="co"># Adding y to df</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span></span>
<span>  <span class="va">df</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">myData</span> <span class="op">&lt;-</span> <span class="fu">genFriedman</span><span class="op">(</span>noFeatures <span class="op">=</span> <span class="fl">9</span>, noSamples <span class="op">=</span> <span class="fl">350</span>, sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-fit">Model fit<a class="anchor" aria-label="anchor" href="#model-fit"></a>
</h3>
<p>Here we create two model fits. We create a random forest fit from the
<code>randomForest</code> package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">myData</span>, importance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Note that for a <code>randomForest</code> model, if
<code>importance = TRUE</code>, then multiple importance metrics are
returned. In order to choose a specific metric for use with
<code>vivid</code>, it is necessary to specify one of the importance
metrics returned by the random forest as the argument for the
<code>importanceType</code> parameter in the <code>vivi</code> function
(as shown below).</p>
</div>
<div class="section level3">
<h3 id="vivi-function">vivi function<a class="anchor" aria-label="anchor" href="#vivi-function"></a>
</h3>
<p>To utilize <code>vivid</code>, the initial step involves computing
variable importance and interactions for a fitted model. The vivi
function performs this calculation, producing a square, symmetrical
matrix that contains variable importance on the diagonal and variable
interactions on the off-diagonal. To calculate the pair-wise interaction
strength interactions Friedman’s model agnostic, unnormalized <span class="math inline">\(H\)</span>-Statistic<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Friedman, J. H. and Popescu, B. E. (2008). “Predictive
learning via rule ensembles.” The Annals of Applied Statistics. JSTOR,
916–54.&lt;/p&gt;"><sup>2</sup></a> is used. The
unnormalized version of the <span class="math inline">\(H\)</span>-statistic was chosen to have a more
direct comparison of interaction effects across pairs of variables and
the results of <span class="math inline">\(H\)</span> are on the scale
of the response (for regression). For the importance, either a selected
embedded importance measure can be used or an agnostic permutation
method<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Fisher A., Rudin C., Dominici F. (2018). All Models are
Wrong but many are Useful: Variable Importance for Black-Box,
Proprietary, or Misspecified Prediction Models, using Model Class
Reliance. Arxiv.&lt;/p&gt;"><sup>3</sup></a>
can be selected (examples of which are shown below).</p>
<p>The vivi function requires three inputs: a fitted machine learning
model, a data frame used in the model’s training, and the name of the
response variable for the fit. The resulting matrix will have importance
and interaction values for all variables in the data frame, excluding
the response variable.</p>
<p>Any variables that are not used by the supplied model will have their
importance and interaction values set to <code>NA</code>. While the
<code>viviHeatmap</code> and <code>viviNetwork</code> visualization
functions (seen below) are tailored for displaying the results of vivi
calculations, they can also work with any square matrix that has
identical row and column names. (Note, the symmetry assumption is not
required for <code>viviHeatmap</code> and <code>viviNetwork</code> uses
interaction values from the lower-triangular part of the matrix
only.)</p>
<p>This function works with multiple model fits and results in a matrix
which can be supplied to the plotting functions. The predict function
argument uses <code><a href="https://cbhurley.github.io/condvis2/reference/CVpredict.html" class="external-link">condvis2::CVpredict</a></code> by default, which works
for many fit classes. To see a description of all function arguments
use: <code>?vivid::vivi()</code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">viviRf</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rf</span>, </span>
<span>                data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>                response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                gridSize <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                importanceType <span class="op">=</span> <span class="st">"%IncMSE"</span>,</span>
<span>                nmax <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                class <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                predictFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                numPerm <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="section-2-visualizing-the-results">Section 2: Visualizing the results<a class="anchor" aria-label="anchor" href="#section-2-visualizing-the-results"></a>
</h2>
<div class="section level4">
<h4 id="heatmap-plot">Heatmap plot<a class="anchor" aria-label="anchor" href="#heatmap-plot"></a>
</h4>
<p>The <code>viviHeatmap</code> function generates a heatmap that
displays variable importance and interactions, with importance values on
the diagonal and interaction values on the off-diagonal. The function
only requires a <code>vivid</code> matrix as input, which does not need
to be symmetrical. Additionally, color palettes can be specified for
both importance and interactions via the <code>impPal</code> and
<code>intPal</code> arguments. By default, we have opted for single-hue,
color-blind friendly sequential color palettes developed by Zeileis et
al<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Zeileis, Achim, Jason C. Fisher, Kurt Hornik, Ross
Ihaka, Claire D. McWhite, Paul Murrell, Reto Stauffer, and Claus O.
Wilke. 2020. “Colorspace: A Toolbox for Manipulating and Assessing
Colors and Palettes.” Journal of Statistical Software, Articles 96 (1):
1–49&lt;/p&gt;"><sup>4</sup></a>.
These palettes represent low and high VIVI values with low and high
luminance colors, respectively, which can aid in highlighting pertinent
values.</p>
<p>The <code>impLims</code> and <code>intLims</code> arguments determine
the range of importance and interaction values that will be assigned
colors. If these arguments are not provided, the default values will be
calculated based on the minimum and maximum VIVI values in the
<code>vivid</code> matrix. If any importance or interaction values fall
outside of the specified limits, they will be squished to the closest
limit. For brevity, only the required <code>vivid</code> matrix input is
shown in the following code. To see a description of all the function
arguments, see <code>?vivid::viviheatmap()</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfheatmap.png" width="100%"><center>
<caption>
<span id="fig1:fig1">Figure 1: </span>Heatmap of a random forest fit
displaying 2-way interaction strength on the off diagonal and individual
variable importance on the diagonal. <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> show a strong interaction with <span class="math inline">\(x_4\)</span> being the most important for
predicting <span class="math inline">\(y\)</span>.
</caption>
</center>
</div>
<div class="section level4">
<h4 id="network-plot">Network plot<a class="anchor" aria-label="anchor" href="#network-plot"></a>
</h4>
<p>With <code>viviNetwork</code>, a network graph is produced to
visualize both importance and interactions. Similar to
<code>viviHeatmap</code>, this function only requires a
<code>vivid</code> matrix as input and uses visual elements, such as
size and color, to depict the magnitude of importance and interaction
values. The graph displays each variable as a node, where its size and
color reflect its importance (larger and darker nodes indicate higher
importance). Pairwise interactions are displayed through connecting
edges, where thicker and darker edges indicate higher interaction
values.</p>
<p>To begin we show the network using default settings.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfnetwork.png" width="100%"><center>
<caption>
<span id="fig2:fig2">Figure 2: </span>Network plot of a random forest
fit displaying 2-way interaction strength and individual variable
importance. <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> show a strong interaction with <span class="math inline">\(x_4\)</span> being the most important for
predicting <span class="math inline">\(y\)</span>.
</caption>
</center>
<p>We can also filter out any interactions below a set value using the
<code>intThreshold</code> argument. This can be useful when the number
of variables included in the model is large or just to highlight the
strongest interactions. By default, unconnected nodes are displayed,
however, they can be removed by setting the argument
<code>removeNode = T</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span>, intThreshold <span class="op">=</span> <span class="fl">0.12</span>, removeNode <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span>, intThreshold <span class="op">=</span> <span class="fl">0.12</span>, removeNode <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfnet_filter_comb1.png" width="100%"><center>
<caption>
<span id="fig3:fig3">Figure 3: </span>Network plot of a random forest
fit displaying 2-way interaction strength and individual variable
importance. In (a) a filtered network is shown displaying all
interactions above 0.12, with all nodes shown. In (b) the unconnected
nodes are removed.
</caption>
</center>
<p>The network plot offers multiple customization possibilities when it
comes to displaying the network style plot through use of the
<code>layout</code> argument. The default layout is a circle but the
argument accepts any <code>igraph</code> layout function or a numeric
matrix with two columns, one row per node.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span>, </span>
<span>            layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfnet_custom_layout.png" width="70%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig4:fig4">Figure 4: </span>Network plot of a random forest
fit using custom layout.
</caption>
</center>
<p>Finally, for the network plot to highlight any relationships in the
model fit, we can cluster variables together using the
<code>cluster</code> argument. This argument can either accept a vector
of cluster memberships for nodes or an <code>igraph</code> package
clustering function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span>, cluster <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/igraph/man/cluster_fast_greedy.html" class="external-link">cluster_fast_greedy</a></span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfnet_cluster.png" width="70%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig5:fig5">Figure 5: </span>Clustered network plot of a random
forest fit.
</caption>
</center>
</div>
<div class="section level4">
<h4 id="univariate-partial-dependence-plot">Univariate Partial Dependence Plot<a class="anchor" aria-label="anchor" href="#univariate-partial-dependence-plot"></a>
</h4>
<p>The <code>pdpVars</code> function constructs a grid of univariate
PDPs with ICE curves for selected variables. We use ICE curves to assist
in the identification of linear or non-linear effects. The fit, data
frame used to train the model, and the name of the response variable are
required inputs.</p>
<p>In the example below, we select the first five variables from our
created <code>vivid</code> matrix to display.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">viviRf</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/pdpVars.html">pdpVars</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>,</span>
<span>        fit <span class="op">=</span> <span class="va">rf</span>,</span>
<span>        response <span class="op">=</span> <span class="st">'y'</span>,</span>
<span>        vars <span class="op">=</span> <span class="va">top5</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfpdp.png" width="100%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig6:fig6">Figure 6: </span>Partial dependence plots (black
line) with individual conditional expectation curves (colored lines) of
a random forest fit on the Friedman data. The changing partial
dependence and ICE curves of <span class="math inline">\(x1\)</span>,
<span class="math inline">\(x2\)</span>, and <span class="math inline">\(x4\)</span> indicate that these variables have
some impact on the response.
</caption>
</center>
</div>
<div class="section level4">
<h4 id="generalized-partial-dependence-pairs-plot">Generalized partial dependence pairs plot<a class="anchor" aria-label="anchor" href="#generalized-partial-dependence-pairs-plot"></a>
</h4>
<p>By employing a matrix layout, the pdpPairs function generates a
generalized pairs partial dependence plot (GPDP) that encompasses
univariate partial dependence (with ICE curves) on the diagonal,
bivariate partial dependence on the upper diagonal, and a scatterplot of
raw variable values on the lower diagonal, where all colours are
assigned to points and ICE curves by the predicted <span class="math inline">\(\hat{y}\)</span> value. As with the univariate
PDP, the fit, data frame used to train the model, and the name of the
response variable are required inputs. For a full description of all the
function arguments, see <code><a href="../reference/pdpPairs.html">?vivid::pdpPairs</a></code>. In the following
example, we select the first five variables to display and set the
number of shown ICE curves to 100.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpPairs.html">pdpPairs</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>         fit <span class="op">=</span>  <span class="va">rf</span>, </span>
<span>         response <span class="op">=</span> <span class="st">"y"</span>, </span>
<span>         nmax <span class="op">=</span> <span class="fl">500</span>, </span>
<span>         gridSize <span class="op">=</span> <span class="fl">10</span>,         </span>
<span>         vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span><span class="op">)</span>,</span>
<span>         nIce <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfGPGP_subset.png" width="80%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig7:fig7">Figure 7: </span>Filtered generalized pairs partial
dependence plot for a random forest fit on the Friedman data. From both
the univariate and bivariate PDPs, we can see that <span class="math inline">\(x1\)</span>, <span class="math inline">\(x2\)</span>, and <span class="math inline">\(x4\)</span> have an impact on the response.
</caption>
</center>
</div>
<div class="section level4">
<h4 id="partial-dependence-zenplot">Partial dependence ‘Zenplot’<a class="anchor" aria-label="anchor" href="#partial-dependence-zenplot"></a>
</h4>
<p>The <code>pdpZen</code> function utilizes a space-saving technique
based on graph Eulerians, introduced by Hierholzer and Wiener in 1873<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Hierholzer, Carl, and Chr Wiener. 1873. “Über Die
möglichkeit, Einen Linienzug Ohne Wiederholung Und Ohne Unterbrechung Zu
Umfahren.” Mathematische Annalen 6 (1): 30–32.&lt;/p&gt;"><sup>5</sup></a> to create
partial dependence plots. We refer to these plots as zen-partial
dependence plots (ZPDP). These plots are based on zigzag expanded
navigation plots, also known as zenplots, which are available in the
zenplots package<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Hofert, Marius, and Wayne Oldford. 2020. “Zigzag
Expanded Navigation Plots in R: The R Package zenplots.” Journal of
Statistical Software 95 (4): 1–44.&lt;/p&gt;"><sup>6</sup></a>. Zenplots were designed to showcase paired
graphs of high-dimensional data with a focus on the most significant 2D
displays. In our version, we display bivariate PDPs that emphasize
variables with the most significant interaction values in a compact
zigzag layout. This format is useful when dealing with high-dimensional
predictor space.</p>
<p>To begin, we show a ZPDP using all the variables in the model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpZen.html">pdpZen</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, fit <span class="op">=</span> <span class="va">rf</span>, response <span class="op">=</span> <span class="st">"y"</span>, nmax <span class="op">=</span> <span class="fl">500</span>, gridSize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfzen_all.png" width="60%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig8:fig8">Figure 8: </span>Zen partial dependence plot for
the random forest fit on the Friedman data. Here we display all the
variables used in the random forest model.
</caption>
</center>
<p>In Fig 8, we can see PDPs laid out in a zigzag structure, with the
most influential variable pairs displayed at the top and generally
decreasing as we move down. In Figure 9, below, we select a subset of
variables to display. In this case we select the first five variables
from the data. The argument <code>zpath</code> specifies the variables
to be plotted, defaulting to all dataset variables aside from the
response.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpZen.html">pdpZen</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>       fit <span class="op">=</span> <span class="va">rf</span>, </span>
<span>       response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>       nmax <span class="op">=</span> <span class="fl">500</span>, </span>
<span>       gridSize <span class="op">=</span> <span class="fl">10</span>, </span>
<span>       zpath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfzen_subset.png" width="70%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig9:fig9">Figure 9: </span>Zen partial dependence plot for
the random forest fit on the Friedman data. Here we display only the
first five variables.
</caption>
</center>
<p>We can also create a sequence or sequences of variable paths for use
in <code>pdpZen.</code> via the <code>zPath</code> function. The zPath
function takes four arguments. These are: <code>viv</code> - a matrix of
interaction values, <code>cutoff</code> - exclude interaction values
below this threshold, <code>method</code> - a string indicating which
method to use to create the path, and <code>connect</code> - a logical
value indicating if separate Eulerians should be connected.</p>
<p>You can choose between two methods when using the <code>zPath</code>
function: <code>"greedy.weighted"</code> and
<code>"strictly.weighted"</code>. The first method utilizes a greedy
Eulerian path algorithm for connected graphs. This method traverses each
edge at least once, beginning at the highest-weighted edge, and moving
on to the remaining edges while prioritizing the highest-weighted edge.
If the graph has an odd number of nodes, some edges may be visited more
than once, or additional edges may be visited. The second method,
<code>"strictly.weighted"</code> visits edges in strictly decreasing
order by weight (in this case, interaction values). If the connect
argument is set to <code>TRUE</code>, the sequences generated by the
strictly weighted method are combined to create a single path. In the
code below, we provide an example of creating zen-paths using the
<code>"strictly.weighted"</code> method, from the top 10% of interaction
scores in <code>viviRf</code> (i.e., the created <code>vivid</code>
matrix.)</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set zpaths with different parameters</span></span>
<span><span class="va">intVals</span> <span class="op">&lt;-</span> <span class="va">viviRf</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">intVals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">intThresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">intVals</span>, <span class="fl">.90</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">zpSw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/zPath.html">zPath</a></span><span class="op">(</span>viv <span class="op">=</span> <span class="va">viviRf</span>, cutoff <span class="op">=</span> <span class="va">intThresh</span>, connect <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">'strictly.weighted'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpZen.html">pdpZen</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>       fit <span class="op">=</span> <span class="va">rf</span>, </span>
<span>       response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>       nmax <span class="op">=</span> <span class="fl">500</span>, </span>
<span>       gridSize <span class="op">=</span> <span class="fl">10</span>, </span>
<span>       zpath <span class="op">=</span> <span class="va">zpSw</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfzen_SW.png" width="70%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig10:fig10">Figure 10: </span>ZPDP for a random forest fit on
the Friedman data. The sorting method is defined by the
’strictly.weighted‘ method and is un-connected.
</caption>
</center>
</div>
</div>
<div class="section level2">
<h2 id="section-3-example-using-the-predict-function">Section 3: Example using the predict function<a class="anchor" aria-label="anchor" href="#section-3-example-using-the-predict-function"></a>
</h2>
<p>We supply an internal custom predict function called
<code>CVpredictfun</code> to both importance and interaction
calculations. <code>CVpredictfun</code> is a wrapper around
<code>CVpredict</code> from the <code>condvis2</code> package<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Hurley, Catherine, Mark OConnell, and Katarina Domijan.
2022. Condvis2: Interactive Conditional Visualization for Supervised and
Unsupervised Models in Shiny.&lt;/p&gt;"><sup>7</sup></a>.
<code>CVpredict</code> accepts a broad range of fit classes thus
streamlining the process of calculating variable importance and
interactions.</p>
<p>In situations where the fit class is not handled by
<code>CVpredict</code>, supplying a custom predict function to the
<code>vivi</code> function by way of the <code>predictFun</code>
argument allows the agnostic VIVI values to be calculated. In the
following, we provide a small example of using such a fit with
<code>vivid</code> by using the <code>xgboost</code> package to create a
gradient boosting machine (GBM). TO begin we build the model.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dmlc/xgboost" class="external-link">"xgboost"</a></span><span class="op">)</span></span>
<span><span class="va">gbst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html" class="external-link">xgboost</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">myData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                label <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">myData</span><span class="op">[</span>,<span class="fl">10</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                nrounds <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>We then build the <code>vivid</code> matrix for the GBM fit using a
custom predict function, which must be of the form given in the code
snippet.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># predict function for GBM</span></span>
<span><span class="va">pFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">viviGBst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">gbst</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">myData</span>,</span>
<span>                 response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                 reorder <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 normalized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 predictFun <span class="op">=</span> <span class="va">pFun</span>,</span>
<span>                 gridSize <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                 nmax <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<p>From this we can now create our visualisations. For brevity, we only
show the heatmap.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviGBst</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/gbmheat.png" width="100%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig11:fig11">Figure 11: </span>Heatmap for the GBM fit on the
Friedman data.
</caption>
</center>
</div>
<div class="section level2">
<h2 id="section-4-classification-example">Section 4: Classification example<a class="anchor" aria-label="anchor" href="#section-4-classification-example"></a>
</h2>
<p>In this section, we briefly describe how to apply the above
visualisations to a classification example using the <code>iris</code>
data set.</p>
<p>To begin we fit a <code>ranger</code> random forest model with
“Species” as the response and create the vivi matrix setting the
category for classification to be “setosa” using <code>class</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">rfClassif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ranger/man/ranger.html" class="external-link">ranger</a></span><span class="op">(</span><span class="va">Species</span><span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, probability <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                    importance <span class="op">=</span> <span class="st">"impurity"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">viviClassif</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rfClassif</span>, </span>
<span>                     data <span class="op">=</span> <span class="va">iris</span>, </span>
<span>                     response <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>                     gridSize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                     nmax <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                     reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     class <span class="op">=</span> <span class="st">"setosa"</span><span class="op">)</span></span></code></pre></div>
<p>Next we plot the heatmap and network plot of the iris data.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviClassif</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviClassif</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/classifVIVI.png" width="100%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig12:fig12">Figure 12: </span>Heatmap in (a) and Network plot
in (b) of random forest fit on the iris data
</caption>
</center>
<p>As mentioned above, as PDPs are evaluated on a grid and can
extrapolate where there is no data. To solve this issue we calculate a
convex hull around the data and remove any points that fall outside the
convex hull, as shown below.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpPairs.html">pdpPairs</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, </span>
<span>         fit <span class="op">=</span> <span class="va">rfClassif</span>, </span>
<span>         response <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>         class <span class="op">=</span> <span class="st">"setosa"</span>,  </span>
<span>         convexHull <span class="op">=</span> <span class="cn">T</span>, </span>
<span>         gridSize <span class="op">=</span> <span class="fl">10</span>, </span>
<span>         nmax <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> </span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/classifGPDP.png" width="80%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig12:fig12">Figure 12: </span>GPDP of random forest fit on
the iris data with extrapolated data removed.
</caption>
</center>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alan Inglis, Andrew Parnell, Catherine Hurley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
