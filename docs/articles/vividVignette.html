<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>vivid: Variable Importance and Variable Interaction Displays • vivid</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="vivid: Variable Importance and Variable Interaction Displays">
<meta property="og:description" content="vivid">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vivid</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vividVignette.html">vivid: Variable Importance and Variable Interaction Displays</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vividVignette_files/header-attrs-2.24/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>vivid: Variable Importance and Variable
Interaction Displays</h1>
            
      
      
      <div class="hidden name"><code>vividVignette.Rmd</code></div>

    </div>

    
    
<!-- avoid border around images -->
<style>
img {
  border: 0;
  }
</style>
<div id="section-1-introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#section-1-introduction" class="anchor"></a>Section 1: Introduction</h2>
<div id="introduction-to-vivid" class="section level3">
<h3 class="hasAnchor">
<a href="#introduction-to-vivid" class="anchor"></a>Introduction to vivid</h3>
<!-- badges: start -->
<p><img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/badge/vividLogoNew2.png" width="240" height="276" align="right"><!-- badges: end --></p>
<p>Variable importance (VImp), variable interaction measures (VInt) and
partial dependence plots (PDPs) are important summaries in the
interpretation of statistical and machine learning models. In this
vignette we describe new visualization techniques for exploring these
model summaries. We construct heatmap and graph-based displays showing
variable importance and interaction jointly, which are carefully
designed to highlight important aspects of the fit. We describe a new
matrix-type layout showing all single and bivariate partial dependence
plots, and an alternative layout based on graph Eulerians focusing on
key subsets. Our new visualisations are model-agnostic and are
applicable to regression and classification supervised learning
settings. They enhance interpretation even in situations where the
number of variables is large and the interaction structure complex. Our
R package <code>vivid</code> (variable importance and variable
interaction displays) provides an implementation. When referring to VImp
and VInt together, we use the shorthand VIVI. For more information
related to visualising variable importance and interactions in machine
learning models see our published work[1].</p>
</div>
<div id="install-instructions" class="section level3">
<h3 class="hasAnchor">
<a href="#install-instructions" class="anchor"></a>Install instructions</h3>
<p>Some of the plots used by <code>vivid</code> are built upon the
<code>zenplots</code> package which requires the <code>graph</code>
package from BioConductor. To install the <code>graph</code> and
<code>zenplots</code> packages use:</p>
<p><code>if (!requireNamespace("graph", quietly = TRUE)){</code>
<code>install.packages("BiocManager")</code>
<code>BiocManager::install("graph")</code><br><code>}</code> <code>install.packages("zenplots")</code></p>
<p>Now we can install <code>vivid</code> by using:</p>
<p><code>install.packages("vivid")</code></p>
<p>Alternatively you can install the latest development version of the
package in R with the commands:</p>
<p><code>if(!require(remotes)) install.packages('remotes')</code>
<code>remotes::install_github('AlanInglis/vividPackage')</code></p>
<p>We then load the <code>vivid</code> package via:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://alaninglis.github.io/vivid/">vivid</a></span><span class="op">)</span> </span></code></pre></div>
</div>
</div>
<div id="section-2-background" class="section level2">
<h2 class="hasAnchor">
<a href="#section-2-background" class="anchor"></a>Section 2: Background</h2>
<p>VIVI metrics can be categorized into two types: those that are
model-specific (embedded) and those that are model-agnostic. Here we
provide a brief background on variable importance, variable
interactions, and partial dependence and discuss their use in
<code>vivid</code>.</p>
<div id="variable-importance" class="section level3">
<h3 class="hasAnchor">
<a href="#variable-importance" class="anchor"></a>Variable Importance</h3>
<p>The importance value of a variable measures the extent to which it
impacts the model’s output. Embedded methods weave variable importance
directly into the machine learning algorithm. For instance, machine
learning methods like random forests (RF)[2] and gradient boosting
machines (GBM)[3] utilize their tree-based architecture to evaluate the
performance of the model. Similarly, Bayesian additive regression tree
models (BART)[4] adopt an embedded approach to yield VIVI metrics by
measuring the proportion of splitting rules for for individual or paired
variables in the trees.</p>
<p>The package <code>randomForestExplainer</code>[5] offers a toolkit
for deciphering the inner workings of a random forest. It applies the
minimal depth concept[6] to gauge both the significance and interaction
strength by observing a variable’s location within the trees. Moreover,
the <code>varImp</code> package[7] facilitates the computation of
importance scores for the <code>party</code> package’s conditional
inference random forest[8]. For gradient boosted machines, the
<code>EIX</code>[9] package can be used to calculate VIVI, and
graphically represent the findings.</p>
<p>Model-agnostic techniques are universally applicable to any ML
algorithm. These methods offer flexibility in model choice and are
valuable for comparing various ML models. Permutation importance[2], a
model-agnostic method, assesses VImps by computing the change in a
model’s predictive accuracy after permuting a variable. This approach is
available in the <code>iml</code>[10], <code>flashlight</code>[11],
<code>DALEX</code>[12], and <code>vip</code>[13] packages.</p>
<p>In <code>vivid</code> we provide the functionality to calculate
either an agnostic or model-specific importance.</p>
<ol style="list-style-type: decimal">
<li>To calculate agnostic importance, <code>vivid</code> uses a
permutation approach[14]. In this approach, the model’s error score
(e.g., root mean square error) is first determined. Afterward, each
feature is randomly permuted, and the error score is computed again. The
change in performance indicates the importance score of that particular
feature. The permutation algorithm can be described in the
following:</li>
</ol>
<p><strong>Permutation Importance Algorithm:</strong></p>
<p><strong>Input:</strong> Fitted predicted model <span class="math inline">\(m\)</span>, dataset <span class="math inline">\(D\)</span></p>
<p><strong>Compute:</strong> Compute error score <span class="math inline">\(w_{k}\)</span> of the fitted model <span class="math inline">\(m\)</span> on data <span class="math inline">\(D\)</span>.</p>
<p><strong>For each feature <span class="math inline">\(k\)</span>
(column of <span class="math inline">\(D\)</span>)</strong></p>
<ul>
<li>For each repetition <span class="math inline">\(r\)</span> in <span class="math inline">\(1,...,R\)</span>:
<ol style="list-style-type: decimal">
<li>Randomly shuffle column <span class="math inline">\(k\)</span> of
dataset <span class="math inline">\(D\)</span> to generate a shuffled
version of the data.</li>
<li>Compute the score <span class="math inline">\({w}^*_{r,k}\)</span>
of model <span class="math inline">\(m\)</span> on shuffled data.</li>
</ol>
</li>
<li>Compute importance <span class="math inline">\(\texttt{imp}_k\)</span> for feature <span class="math inline">\(f_k\)</span> defined as:</li>
</ul>
<p><span class="math display">\[\begin{equation}
  \tag{1}
  \texttt{imp}_k = w_{k} - \frac{1}{R}\sum_{r = 1}^Rw^*_{rk}
  \end{equation}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>For model-specific variable importance, we provide individual
methods to access importance scores for some of the most popular model
fitting R packages, namely; ranger[15], mlr[16], mlr3[17], and
parsnip[18]. See Section <code>Model Fits</code> for more details on
using different models with <code>vivid</code>.</li>
</ol>
</div>
<div id="partial-dependence" class="section level3">
<h3 class="hasAnchor">
<a href="#partial-dependence" class="anchor"></a>Partial Dependence</h3>
<p>Friedman (2000)[19] introduced Partial Dependence Plots (PDPs) as a
model-agnostic method to visualize the relationship between a chosen
predictor and the model outcome, while averaging out the effects of
other predictors. Individual Conditional Expectation (ICE) curves,
introduced by Goldstein et al. (2015)[20], depict the relationship
between a specific predictor and the model outcome by setting other
predictors at certain observation levels. Essentially, PDPs represent
the averaged outcome of all ICE curves in the dataset. The iml, DALEX,
flashlight, and pdp[21] R packages offer PDP functionalities, while the
ICEbox package[20] caters to ICE curves and their variations. The
partial dependence of the model fit function <span class="math inline">\(g\)</span> on predictor variables <span class="math inline">\(S\)</span> (where <span class="math inline">\(S\)</span> is a subset of the <span class="math inline">\(p\)</span> predictor variables) is estimated
as:</p>
<p><span class="math display">\[\begin{equation}
\tag{2}
f_S(\mathbf{x}_S)=\frac{1}{n}\sum^n_{i=1}g(\mathbf{x}_s,\mathbf{x}_{C_i})
\end{equation}\]</span></p>
<p>where <span class="math inline">\(C\)</span> denotes predictors other
than those in <span class="math inline">\(S\)</span>, <span class="math inline">\({x_{C_1},x_{C_2},...,x_{C_n}}\)</span> are the
values of <span class="math inline">\(x_C\)</span> occurring in the
training set of n observations, and <span class="math inline">\(g()\)</span> gives the predictions from the
machine learning model. For one or two variables, the partial dependence
functions <span class="math inline">\(f_S(\mathbf{x}_S)\)</span> are
plotted (a so-called PDP) to display the marginal fits.</p>
</div>
<div id="variable-interactions" class="section level3">
<h3 class="hasAnchor">
<a href="#variable-interactions" class="anchor"></a>Variable Interactions</h3>
<p>For VInts, the H-statistic by Friedman and Popescu (2008)[22] is a
model-agnostic measure that gauges interactions using partial
dependence. It contrasts the joint effects of a variable pair with the
sum of their marginal effects.. This is implemented in the
<code>iml</code> and <code>flashlight</code> packages and is defined
as:</p>
<p><span class="math display">\[\begin{equation}
\tag{3}
H^2_{jk}=\frac{\sum^n_{i=1}[f_{jk}(x_{ij},x_{ik})-f_j(x_{ij})-f_k(x_{ik})]^2}{\sum^n_{i=1}f^2_{jk}(x_{ij},x_{ik})}
\end{equation}\]</span></p>
<p>However, when the denominator in Equation 2 is small, the partial
dependence of variables <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span> remains constant. As a result, minor
variations in the numerator can produce spuriously high <span class="math inline">\(H\)</span>-values. Consequently, in
<code>vivid</code> we use the the unnormalized <span class="math inline">\(H\)</span>-Statistic to calculate the pair-wise
interaction strength. The unnormalized version of the <span class="math inline">\(H\)</span>-statistic was chosen to have a more
direct comparison of interaction effects across pairs of variables by
reducing the identification of spurious interactions and gives the
results of <span class="math inline">\(H\)</span> on the scale of the
response (for regression).</p>
<p><span class="math display">\[\begin{equation}
\tag{4}
H_{jk}=\sqrt{\frac{1}{n}\sum^n_{i=1}[f_{jk}(x_{ij},x_{ik})-f_j(x_{ij})-f_k(x_{ik})]^2}
\end{equation}\]</span></p>
</div>
</div>
<div id="section-3-data-and-model" class="section level2">
<h2 class="hasAnchor">
<a href="#section-3-data-and-model" class="anchor"></a>Section 3: Data and Model</h2>
<div id="data-used-in-this-vignette" class="section level3">
<h3 class="hasAnchor">
<a href="#data-used-in-this-vignette" class="anchor"></a>Data used in this vignette</h3>
<p>The data used in the following examples is simulated from the
Friedman benchmark problem[23]. This benchmark problem is commonly used
for testing purposes. The output is created according to the
equation:</p>
<p><span class="math display">\[\begin{equation}
\tag{5}
y = 10 sin(π x_1 x_2) + 20 (x_3 - 0.5)^2 + 10 x_4 + 5 x_5 + e
\end{equation}\]</span></p>
<p>For the following examples we set the number of features to equal 9
and the number of samples is set to 350 and fit a
<code>randomForest</code> random forest model with <span class="math inline">\(y\)</span> as the response. As the features <span class="math inline">\(x_1\)</span> to <span class="math inline">\(x_5\)</span> are the only variables in the model,
therefore <span class="math inline">\(x_6\)</span> to <span class="math inline">\(x_{9}\)</span> are noise variables. As can be seen
by the above equation, the only interaction is between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span></p>
<p>Create the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">genFriedman</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">noFeatures</span> <span class="op">=</span> <span class="fl">10</span>, <span class="va">noSamples</span> <span class="op">=</span> <span class="fl">100</span>, <span class="va">sigma</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Create dataframe with named columns</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">noSamples</span> <span class="op">*</span> <span class="va">noFeatures</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">noSamples</span><span class="op">)</span>, </span>
<span>                               stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">noFeatures</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Equation: y = 10sin(πx1x2) + 20(x3−0.5)^2 + 10x4 + 5x5 + ε</span></span>
<span>  </span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">pi</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x1</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fl">20</span> <span class="op">*</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x3</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> </span>
<span>    <span class="fl">10</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x4</span> <span class="op">+</span> </span>
<span>    <span class="fl">5</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x5</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">noSamples</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span> <span class="co"># error</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">myData</span> <span class="op">&lt;-</span> <span class="fu">genFriedman</span><span class="op">(</span>noFeatures <span class="op">=</span> <span class="fl">9</span>, noSamples <span class="op">=</span> <span class="fl">350</span>, sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span></code></pre></div>
</div>
<div id="model-fit" class="section level3">
<h3 class="hasAnchor">
<a href="#model-fit" class="anchor"></a>Model Fit</h3>
<p>Part of the intention behind <code>vivid</code> was to create a
package that facilitated ease of use coupled with the flexibility to use
the agnostic VIVI methods on a wide range of machine learning (ML)
models. Section <code>Model Fits</code> provides practical examples of
how to use <code>vivid</code> with some of the more popular ML
algorithms. For brevity, for the following examples, we create a random
forest fit from the <code>randomForest</code> package to use with
<code>vivid</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span> <span class="co"># for model fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">myData</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="section-4-vivi" class="section level2">
<h2 class="hasAnchor">
<a href="#section-4-vivi" class="anchor"></a>Section 4: vivi</h2>
<div id="vivi-function" class="section level3">
<h3 class="hasAnchor">
<a href="#vivi-function" class="anchor"></a>vivi function</h3>
<p>The <code>vivi</code> function calculates both the importance and
interactions using S3 methods. By default, the agnostic importance and
interaction scores in vivid are computed using the generalized predict
function from the <code>condvis2</code> package. Consequently, vivid can
be used out-of-the-box with any model type that works with
<code>condvis2</code> predict (see <code>CVpredict</code> from
<code>condvis2</code> for a full list of compatible model types). To
allow vivid to run with other model fits, a custom predict function must
be passed to the <code>predictFun</code> argument (as discussed in the
Section <code>Custom Predict Function</code>).</p>
<p>The <code>vivi</code> function first computes variable importance and
interactions for a fitted model, then produces a square, symmetrical
matrix that contains variable importance on the diagonal and variable
interactions on the off-diagonal.</p>
<p>The <code>vivi</code> function requires three inputs: a fitted
machine learning model, a data frame used in the model’s training, and
the name of the response variable for the fit. The resulting matrix will
have importance and interaction values for all variables in the data
frame, excluding the response variable. By default, if no embedded
variable importance method is available or selected, an agnostic
permutation method is applied. For clarity, this is shown in the
<code>importanceType = 'agnostic'</code> argument below. For an example
of using embedded methods, see Section <code>Embedded VImps</code>.</p>
<p>Any variables that are not used by the supplied model will have their
importance and interaction values set to zero. While the
<code>viviHeatmap</code> and <code>viviNetwork</code> visualization
functions (seen in the Section <code>Visualisations</code>) are tailored
for displaying the results of vivi calculations, they can also work with
any square matrix that has identical row and column names. (Note, the
symmetry assumption is not required for <code>viviHeatmap</code> and
<code>viviNetwork</code> uses interaction values from the
lower-triangular part of the matrix only.) To see a description of all
function arguments use: <code>?vivid::vivi()</code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">viviRf</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rf</span>, </span>
<span>                data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>                response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                gridSize <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                importanceType <span class="op">=</span> <span class="st">"agnostic"</span>,</span>
<span>                nmax <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                predictFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                numPerm <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                showVimpError <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="section-5-visualisations" class="section level2">
<h2 class="hasAnchor">
<a href="#section-5-visualisations" class="anchor"></a>Section 5: Visualisations</h2>
<div id="visualizing-the-results" class="section level3">
<h3 class="hasAnchor">
<a href="#visualizing-the-results" class="anchor"></a>Visualizing the results</h3>
<p>NOTE: If viewing this vignette from the vivid CRAN page, then some
images may not format correctly. It is recommended to view this vignette
on GitHub via the following link: <a href="https://alaninglis.github.io/vivid/articles/vividVignette.html" class="uri">https://alaninglis.github.io/vivid/articles/vividVignette.html</a></p>
</div>
<div id="heatmap-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#heatmap-plot" class="anchor"></a>Heatmap plot</h3>
<p>The <code>viviHeatmap</code> function generates a heatmap that
displays variable importance and interactions, with importance values on
the diagonal and interaction values on the off-diagonal. The function
only requires a <code>vivid</code> matrix as input, which does not need
to be symmetrical. Additionally, color palettes can be specified for
both importance and interactions via the <code>impPal</code> and
<code>intPal</code> arguments. By default, we have opted for single-hue,
color-blind friendly sequential color palettes developed by Zeileis et
al[24]. These palettes represent low and high VIVI values with low and
high luminance colors, respectively, which can aid in highlighting
pertinent values.</p>
<p>The <code>impLims</code> and <code>intLims</code> arguments determine
the range of importance and interaction values that will be assigned
colors. If these arguments are not provided, the default values will be
calculated based on the minimum and maximum VIVI values in the
<code>vivid</code> matrix. If any importance or interaction values fall
outside of the specified limits, they will be squished to the closest
limit. For brevity, only the required <code>vivid</code> matrix input is
shown in the following code. To see a description of all the function
arguments, see <code>?vivid::viviheatmap()</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfheatmap.png" width="100%"><center>
<caption>
<span id="fig1:fig1">Figure 1: </span>Heatmap of a random forest fit
displaying 2-way interaction strength on the off diagonal and individual
variable importance on the diagonal. <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> show a strong interaction with <span class="math inline">\(x_4\)</span> being the most important for
predicting <span class="math inline">\(y\)</span>.
</caption>
</center>
</div>
<div id="network-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#network-plot" class="anchor"></a>Network plot</h3>
<p>With <code>viviNetwork</code>, a network graph is produced to
visualize both importance and interactions. Similar to
<code>viviHeatmap</code>, this function only requires a
<code>vivid</code> matrix as input and uses visual elements, such as
size and color, to depict the magnitude of importance and interaction
values. The graph displays each variable as a node, where its size and
color reflect its importance (larger and darker nodes indicate higher
importance). Pairwise interactions are displayed through connecting
edges, where thicker and darker edges indicate higher interaction
values.</p>
<p>To begin we show the network using default settings.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfnetwork.png" width="100%"><center>
<caption>
<span id="fig2:fig2">Figure 2: </span>Network plot of a random forest
fit displaying 2-way interaction strength and individual variable
importance. <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> show a strong interaction with <span class="math inline">\(x_4\)</span> being the most important for
predicting <span class="math inline">\(y\)</span>.
</caption>
</center>
<p>We can also filter out any interactions below a set value using the
<code>intThreshold</code> argument. This can be useful when the number
of variables included in the model is large or just to highlight the
strongest interactions. By default, unconnected nodes are displayed,
however, they can be removed by setting the argument
<code>removeNode = T</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span>, intThreshold <span class="op">=</span> <span class="fl">0.12</span>, removeNode <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span>, intThreshold <span class="op">=</span> <span class="fl">0.12</span>, removeNode <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfnet_filter_comb1.png" width="100%"><center>
<caption>
<span id="fig3:fig3">Figure 3: </span>Network plot of a random forest
fit displaying 2-way interaction strength and individual variable
importance. In (a) a filtered network is shown displaying all
interactions above 0.12, with all nodes shown. In (b) the unconnected
nodes are removed.
</caption>
</center>
<p>The network plot offers multiple customization possibilities when it
comes to displaying the network style plot through use of the
<code>layout</code> argument. The default layout is a circle but the
argument accepts any <code>igraph</code> layout function or a numeric
matrix with two columns, one row per node.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span>, </span>
<span>            layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfnet_custom_layout.png" width="70%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig4:fig4">Figure 4: </span>Network plot of a random forest
fit using custom layout.
</caption>
</center>
<p>Finally, for the network plot to highlight any relationships in the
model fit, we can cluster variables together using the
<code>cluster</code> argument. This argument can either accept a vector
of cluster memberships for nodes or an <code>igraph</code> package
clustering function. In the following example, we manually select
variables with VIVI values in the top 20%. This selection allows us to
focus only on the variables with the most impact on the response. The
variables that remain are <span class="math inline">\(x1\)</span> to
<span class="math inline">\(x5\)</span>. We then perform a hierarchical
clustering treating variable interactions as similarities, with the goal
of grouping together high-interaction variables. Here we manually select
the number of groups we want to show via the <code>cutree</code>
function (which cuts clustered data into a desired number of groups).
Finally we rearrange the layout using <code>igraph</code>. Here,
<code><a href="https://r.igraph.org/reference/layout_as_star.html">igraph::layout_as_star</a></code> places the first variable (deemed
most relevant using the VIVI seriation process) at the center, which in
Figure 5 emphasizes its key role as the most important predictor which
also has the strongest interactions.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="co"># clustered and filtered network for rf</span></span>
<span><span class="va">intVals</span> <span class="op">&lt;-</span> <span class="va">viviRf</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">intVals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span> </span>
<span></span>
<span></span>
<span><span class="co"># select VIVI values in top 20%</span></span>
<span><span class="va">impTresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">viviRf</span><span class="op">)</span>,<span class="fl">.8</span><span class="op">)</span></span>
<span><span class="va">intThresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">intVals</span>,<span class="fl">.8</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">viviRf</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">impTresh</span> <span class="op">|</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">intVals</span>, <span class="fl">1</span>, <span class="va">max</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">intThresh</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="va">viviRf</span><span class="op">[</span><span class="va">sv</span>,<span class="va">sv</span><span class="op">]</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"single"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span><span class="va">viviRf</span><span class="op">[</span><span class="va">sv</span>,<span class="va">sv</span><span class="op">]</span>,</span>
<span>            cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">h</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="co"># specify number of groups</span></span>
<span>            layout <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="va"><a href="https://r.igraph.org/reference/layout_as_star.html">layout_as_star</a></span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfnet_cluster.png" width="80%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig5:fig5">Figure 5: </span>Clustered network plot of a random
forest fit.
</caption>
</center>
<p>In Figure 5, after applying a hierarchical clustering, we can see the
strongest mutual interactions have been grouped together. Namley; <span class="math inline">\(x1\)</span>, <span class="math inline">\(x2\)</span>, and <span class="math inline">\(x4\)</span>. The remaining variables are
individually clustered.</p>
</div>
<div id="univariate-partial-dependence-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#univariate-partial-dependence-plot" class="anchor"></a>Univariate Partial Dependence Plot</h3>
<p>The <code>pdpVars</code> function constructs a grid of univariate
PDPs with ICE curves for selected variables. We use ICE curves to assist
in the identification of linear or non-linear effects. The fit, data
frame used to train the model, and the name of the response variable are
required inputs.</p>
<p>In the example below, we select the first five variables from our
created <code>vivid</code> matrix to display and set the number of ICE
curves to be displayed to be 100, via the <code>nIce</code>
argument.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">viviRf</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/pdpVars.html">pdpVars</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>,</span>
<span>        fit <span class="op">=</span> <span class="va">rf</span>,</span>
<span>        response <span class="op">=</span> <span class="st">'y'</span>,</span>
<span>        vars <span class="op">=</span> <span class="va">top5</span>,</span>
<span>        nIce <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfpdp.png" width="100%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig6:fig6">Figure 6: </span>Partial dependence plots (black
line) with individual conditional expectation curves (colored lines) of
a random forest fit on the Friedman data. The changing partial
dependence and ICE curves of <span class="math inline">\(x1\)</span>,
<span class="math inline">\(x2\)</span>, and <span class="math inline">\(x4\)</span> indicate that these variables have
some impact on the response.
</caption>
</center>
</div>
<div id="generalized-partial-dependence-pairs-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#generalized-partial-dependence-pairs-plot" class="anchor"></a>Generalized partial dependence pairs plot</h3>
<p>By employing a matrix layout, the pdpPairs function generates a
generalized pairs partial dependence plot (GPDP) that encompasses
univariate partial dependence (with ICE curves) on the diagonal,
bivariate partial dependence on the upper diagonal, and a scatterplot of
raw variable values on the lower diagonal, where all colours are
assigned to points and ICE curves by the predicted <span class="math inline">\(\hat{y}\)</span> value. As with the univariate
PDP, the fit, data frame used to train the model, and the name of the
response variable are required inputs. For a full description of all the
function arguments, see <code><a href="../reference/pdpPairs.html">?vivid::pdpPairs</a></code>. In the following
example, we select the first five variables to display and set the
number of shown ICE curves to 100.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpPairs.html">pdpPairs</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>         fit <span class="op">=</span>  <span class="va">rf</span>, </span>
<span>         response <span class="op">=</span> <span class="st">"y"</span>, </span>
<span>         nmax <span class="op">=</span> <span class="fl">500</span>, </span>
<span>         gridSize <span class="op">=</span> <span class="fl">10</span>,         </span>
<span>         vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span><span class="op">)</span>,</span>
<span>         nIce <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfGPGP_subset.png" width="80%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig7:fig7">Figure 7: </span>Filtered generalized pairs partial
dependence plot for a random forest fit on the Friedman data. From both
the univariate and bivariate PDPs, we can see that <span class="math inline">\(x1\)</span>, <span class="math inline">\(x2\)</span>, and <span class="math inline">\(x4\)</span> have an impact on the response.
</caption>
</center>
</div>
<div id="partial-dependence-zenplot" class="section level3">
<h3 class="hasAnchor">
<a href="#partial-dependence-zenplot" class="anchor"></a>Partial dependence ‘Zenplot’</h3>
<p>The <code>pdpZen</code> function utilizes a space-saving technique
based on graph Eulerians, introduced by Hierholzer and Wiener in
1873[25] to create partial dependence plots. We refer to these plots as
zen-partial dependence plots (ZPDP). These plots are based on zigzag
expanded navigation plots, also known as zenplots, which are available
in the zenplots package[26]. Zenplots were designed to showcase paired
graphs of high-dimensional data with a focus on the most significant 2D
displays. In our version, we display bivariate PDPs that emphasize
variables with the most significant interaction values in a compact
zigzag layout. This format is useful when dealing with high-dimensional
predictor space.</p>
<p>To begin, we show a ZPDP using all the variables in the model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpZen.html">pdpZen</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, fit <span class="op">=</span> <span class="va">rf</span>, response <span class="op">=</span> <span class="st">"y"</span>, nmax <span class="op">=</span> <span class="fl">500</span>, gridSize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfzen_all.png" width="60%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig8:fig8">Figure 8: </span>Zen partial dependence plot for
the random forest fit on the Friedman data. Here we display all the
variables used in the random forest model.
</caption>
</center>
<p>In Fig 8, we can see PDPs laid out in a zigzag structure, with the
most influential variable pairs displayed at the top and generally
decreasing as we move down. In Figure 9, below, we select a subset of
variables to display. In this case we select the first five variables
from the data. The argument <code>zpath</code> specifies the variables
to be plotted, defaulting to all dataset variables aside from the
response.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpZen.html">pdpZen</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>       fit <span class="op">=</span> <span class="va">rf</span>, </span>
<span>       response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>       nmax <span class="op">=</span> <span class="fl">500</span>, </span>
<span>       gridSize <span class="op">=</span> <span class="fl">10</span>, </span>
<span>       zpath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfzen_subset.png" width="70%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig9:fig9">Figure 9: </span>Zen partial dependence plot for
the random forest fit on the Friedman data. Here we display only the
first five variables.
</caption>
</center>
<p>We can also create a sequence or sequences of variable paths for use
in <code>pdpZen.</code> via the <code>zPath</code> function. The zPath
function takes four arguments. These are: <code>viv</code> - a matrix of
interaction values, <code>cutoff</code> - exclude interaction values
below this threshold, <code>method</code> - a string indicating which
method to use to create the path, and <code>connect</code> - a logical
value indicating if separate Eulerians should be connected.</p>
<p>You can choose between two methods when using the <code>zPath</code>
function: <code>"greedy.weighted"</code> and
<code>"strictly.weighted"</code>. The first method utilizes a greedy
Eulerian path algorithm for connected graphs. This method traverses each
edge at least once, beginning at the highest-weighted edge, and moving
on to the remaining edges while prioritizing the highest-weighted edge.
If the graph has an odd number of nodes, some edges may be visited more
than once, or additional edges may be visited. The second method,
<code>"strictly.weighted"</code> visits edges in strictly decreasing
order by weight (in this case, interaction values). If the connect
argument is set to <code>TRUE</code>, the sequences generated by the
strictly weighted method are combined to create a single path. In the
code below, we provide an example of creating zen-paths using the
<code>"strictly.weighted"</code> method, from the top 10% of interaction
scores in <code>viviRf</code> (i.e., the created <code>vivid</code>
matrix.)</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set zpaths with different parameters</span></span>
<span><span class="va">intVals</span> <span class="op">&lt;-</span> <span class="va">viviRf</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">intVals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">intThresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">intVals</span>, <span class="fl">.90</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">zpSw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/zPath.html">zPath</a></span><span class="op">(</span>viv <span class="op">=</span> <span class="va">viviRf</span>, cutoff <span class="op">=</span> <span class="va">intThresh</span>, connect <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">'strictly.weighted'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpZen.html">pdpZen</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>       fit <span class="op">=</span> <span class="va">rf</span>, </span>
<span>       response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>       nmax <span class="op">=</span> <span class="fl">500</span>, </span>
<span>       gridSize <span class="op">=</span> <span class="fl">10</span>, </span>
<span>       zpath <span class="op">=</span> <span class="va">zpSw</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/rfzen_SW.png" width="70%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig10:fig10">Figure 10: </span>ZPDP for a random forest fit on
the Friedman data. The sorting method is defined by the
’strictly.weighted‘ method and is un-connected.
</caption>
</center>
</div>
</div>
<div id="section-6-custom-predict-function" class="section level2">
<h2 class="hasAnchor">
<a href="#section-6-custom-predict-function" class="anchor"></a>Section 6: Custom Predict Function</h2>
<div id="example-using-the-predict-function" class="section level3">
<h3 class="hasAnchor">
<a href="#example-using-the-predict-function" class="anchor"></a>Example using the predict function</h3>
<p>We supply an internal custom predict function called
<code>CVpredictfun</code> to both importance and interaction
calculations. <code>CVpredictfun</code> is a wrapper around
<code>CVpredict</code> from the <code>condvis2</code> package[27].
<code>CVpredict</code> accepts a broad range of fit classes thus
streamlining the process of calculating variable importance and
interactions. In situations where the fit class is not handled by
<code>CVpredict</code>, supplying a custom predict function to the
<code>vivi</code> function by way of the <code>predictFun</code>
argument allows the agnostic VIVI values to be calculated. For an
example of using <code>vivid</code> with many different types of models,
see the Section <code>Model Fits</code> In the following, we provide a
small example of using such a fit with <code>vivid</code> by using the
<code>xgboost</code> package to create a gradient boosting machine
(GBM). To begin we build the model.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dmlc/xgboost">"xgboost"</a></span><span class="op">)</span></span>
<span><span class="va">gbst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgboost</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">myData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                label <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">myData</span><span class="op">[</span>,<span class="fl">10</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                nrounds <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>We then build the <code>vivid</code> matrix for the GBM fit using a
custom predict function, which must be of the form given in the code
snippet. Note that the term <code>data</code> must be used in the custom
predict function. Do not use the actual name of the data. Additionally,
the response variable should be included when generating the predict
function for <code>xgboost</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># predict function for GBM</span></span>
<span><span class="va">pFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">viviGBst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">gbst</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">myData</span>,</span>
<span>                 response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                 reorder <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 normalized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 predictFun <span class="op">=</span> <span class="va">pFun</span>,</span>
<span>                 gridSize <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                 nmax <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<p>From this we can now create our visualisations. For brevity, we only
show the heatmap.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviGBst</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/gbmheat.png" width="100%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig11:fig11">Figure 11: </span>Heatmap for the GBM fit on the
Friedman data.
</caption>
</center>
</div>
</div>
<div id="section-7-embedded-vimps" class="section level2">
<h2 class="hasAnchor">
<a href="#section-7-embedded-vimps" class="anchor"></a>Section 7: Embedded Vimps</h2>
<div id="using-embedded-importance-metrics" class="section level3">
<h3 class="hasAnchor">
<a href="#using-embedded-importance-metrics" class="anchor"></a>Using embedded importance metrics</h3>
<p>In the following we show examples of how to select different
(embedded) importance metrics for use with the <code>vivi</code>
function. To illustrate the process we use a random forest model fit
using the <code>randomForest</code> and <code>ranger</code>
packages.</p>
</div>
<div id="in-randomforest" class="section level3">
<h3 class="hasAnchor">
<a href="#in-randomforest" class="anchor"></a>In randomForest</h3>
<p>To begin we fit the <code>randomForest</code> model.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">rfEmbedded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">myData</span>, importance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Note that for a <code>randomForest</code> model, if the argument
<code>importance = TRUE</code>, then multiple importance metrics are
returned. In this case, as we have a regression random forest, the
returned importance metrics are the percent increase in mean squared
error (%IncMSE) and the increase in node purity (IncNodePurity). In
order to choose a specific metric for use with <code>vivid</code>, it is
necessary to specify one of the importance metrics returned by the
random forest as the argument for the <code>importanceType</code>
parameter in the <code>vivi</code> function. In the code below we select
the %IncMSE as the importance metric.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">viviRfEmbedded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rfEmbedded</span>, </span>
<span>                       data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>                       response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                       importanceType <span class="op">=</span> <span class="st">"%IncMSE"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="in-ranger" class="section level3">
<h3 class="hasAnchor">
<a href="#in-ranger" class="anchor"></a>In ranger</h3>
<p>For a <code>ranger</code> random forest model, the importance metric
must be specified when fitting the model. In the code below, we select
the <code>impurity</code> as the importance metric.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/imbs-hl/ranger">"ranger"</a></span><span class="op">)</span></span>
<span><span class="va">rang</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ranger/man/ranger.html">ranger</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">myData</span>, importance <span class="op">=</span> <span class="st">'impurity'</span><span class="op">)</span></span></code></pre></div>
<p>Then when calling the <code>vivi</code> function, the
<code>importanceType</code> argument is set to the same selected
importance metric.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">viviRangEmbedded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rang</span>, </span>
<span>                         data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>                         response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                         importanceType <span class="op">=</span> <span class="st">"impurity"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="section-8-model-fits" class="section level2">
<h2 class="hasAnchor">
<a href="#section-8-model-fits" class="anchor"></a>Section 8: Model Fits</h2>
<div id="models-used" class="section level3">
<h3 class="hasAnchor">
<a href="#models-used" class="anchor"></a>Models Used</h3>
<p>This section is designed as a quick-stop guide of how to use some of
the more popular machine learning R packages with <code>vivid</code>.
The visualisations are omitted here as the goal is to familiarize the
user with implementing <code>vivid</code>. As previously discussed,
<code>vivid</code> will work out-of-the-box with several of these R
packages, however, with others, a custom predict function will have to
be supplied. The packages (and models) shown here are:</p>
<ul>
<li>caret - Neural Network</li>
<li>randomForest - Random Forest</li>
<li>ranger - Random Forest</li>
<li>e1071 - Support Vector Machine</li>
<li>gbm - Gradient Boosted Machine</li>
<li>mlr3 - k-nearest Neighbours</li>
<li>xgboost - eXtreme Gradient Boosting</li>
<li>bartMachine - BART</li>
<li>keras - Neural Network</li>
</ul>
<p>For simplicity, in this section we use the popular
<code>air quality</code> dataset, with <em>Ozone</em> as the response.
First we remove any missing values:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="caret---neural-network" class="section level3">
<h3 class="hasAnchor">
<a href="#caret---neural-network" class="anchor"></a>caret - Neural Network</h3>
<p>The <code>caret</code> package (short for Classification And
REgression Training) in R provides a unified interface to streamline the
process of creating predictive models. In the following example, we use
the <code>caret</code> package to utilize a neural network model fit via
the <code>nnet</code> package. As <code>caret</code> is catered for in
<code>vivid</code>, there is no need for a custom predict function
here.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/topepo/caret/">"caret"</a></span><span class="op">)</span></span>
<span><span class="co"># build caret nnet model</span></span>
<span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">aq</span>, method <span class="op">=</span> <span class="st">"nnet"</span>, trace <span class="op">=</span> <span class="cn">FALSE</span>, linout <span class="op">=</span> <span class="cn">TRUE</span>, maxit <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># vivid</span></span>
<span><span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aq</span>, fit <span class="op">=</span> <span class="va">nn</span>, response <span class="op">=</span> <span class="st">'Ozone'</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="randomforest---random-forest" class="section level3">
<h3 class="hasAnchor">
<a href="#randomforest---random-forest" class="anchor"></a>randomForest - Random Forest</h3>
<p>The <code>randomForest</code> package in R implements the Random
Forest algorithm for classification and regression, a popular ensemble
method that builds multiple decision trees during training and
aggregates their results for predictions.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">"randomForest"</a></span><span class="op">)</span></span>
<span><span class="co"># build  random forest model</span></span>
<span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">aq</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># vivid</span></span>
<span><span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aq</span>, fit <span class="op">=</span> <span class="va">rf</span>, response <span class="op">=</span> <span class="st">'Ozone'</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="ranger---random-forest" class="section level3">
<h3 class="hasAnchor">
<a href="#ranger---random-forest" class="anchor"></a>ranger - Random Forest</h3>
<p>The <code>ranger</code> package in R is a fast implementation of
Random Forests, leveraging optimized C++ code for efficiency.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/imbs-hl/ranger">"ranger"</a></span><span class="op">)</span></span>
<span><span class="co"># build  ranger random forest model</span></span>
<span><span class="va">rngr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ranger/man/ranger.html">ranger</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">aq</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># vivid</span></span>
<span><span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aq</span>, fit <span class="op">=</span> <span class="va">rngr</span>, response <span class="op">=</span> <span class="st">'Ozone'</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="e1071---support-vector-machine" class="section level3">
<h3 class="hasAnchor">
<a href="#e1071---support-vector-machine" class="anchor"></a>e1071 - Support Vector Machine</h3>
<p>The <code>e1071</code> package in R provides functions for various
machine learning algorithms including support vector machines
(SVMs).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"e1071"</span><span class="op">)</span></span>
<span><span class="co"># build SVM model</span></span>
<span><span class="va">sv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">aq</span>, kernel <span class="op">=</span> <span class="st">"radial"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># vivid</span></span>
<span><span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aq</span>, fit <span class="op">=</span> <span class="va">sv</span>, response <span class="op">=</span> <span class="st">'Ozone'</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="gbm---generalized-boosted-model" class="section level3">
<h3 class="hasAnchor">
<a href="#gbm---generalized-boosted-model" class="anchor"></a>gbm - Generalized Boosted Model</h3>
<p>The <code>gbm</code> package in R stands for Generalized Boosted
Models. It offers an efficient implementation of gradient boosting
algorithms for classification, regression, and other machine learning
tasks.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/gbm-developers/gbm">"gbm"</a></span><span class="op">)</span></span>
<span><span class="co"># build gbm model</span></span>
<span><span class="va">gm</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/pkg/gbm/man/gbm.html">gbm</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">aq</span>, distribution <span class="op">=</span> <span class="st">"gaussian"</span>, n.trees <span class="op">=</span> <span class="fl">100</span>, interaction.depth <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># vivid</span></span>
<span><span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aq</span>, fit <span class="op">=</span> <span class="va">gm</span>, response <span class="op">=</span> <span class="st">'Ozone'</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="mlr3---k-nearest-neighbours" class="section level3">
<h3 class="hasAnchor">
<a href="#mlr3---k-nearest-neighbours" class="anchor"></a>mlr3 - k-nearest Neighbours</h3>
<p>The <code>mlr3</code> package in R offers a modern, object-oriented
framework for machine learning tasks in R, providing tools for data
preprocessing, model training, evaluation, and tuning. Here, we fit a
k-nearest neighbours model to the data.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3.mlr-org.com">"mlr3"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3learners.mlr-org.com">"mlr3learners"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define a regression task</span></span>
<span><span class="va">task</span> <span class="op">&lt;-</span> <span class="va"><a href="https://mlr3.mlr-org.com/reference/TaskRegr.html">TaskRegr</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"airquality"</span>, backend <span class="op">=</span> <span class="va">aq</span>, target <span class="op">=</span> <span class="st">"Ozone"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Train a gradient boosting model using mlr3</span></span>
<span><span class="va">learner</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">lrn</a></span><span class="op">(</span><span class="st">"regr.kknn"</span><span class="op">)</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="va">learner</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># vivid</span></span>
<span><span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aq</span>, fit <span class="op">=</span> <span class="va">m3</span>, response <span class="op">=</span> <span class="st">'Ozone'</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="bartmachine---bart" class="section level3">
<h3 class="hasAnchor">
<a href="#bartmachine---bart" class="anchor"></a>bartMachine - BART</h3>
<p>The <code>bartMachine</code> package in R provides an implementation
of Bayesian Additive Regression Trees (BART), a non-parametric Bayesian
model which uses decision trees as the underlying model.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"bartMachine"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># build bartMachine model</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bartMachine/man/bartMachine.html">bartMachine</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">aq</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, </span>
<span>                  y <span class="op">=</span> <span class="va">aq</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, </span>
<span>                  num_trees <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                  num_burn_in <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                  num_iterations_after_burn_in <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aq</span>, fit <span class="op">=</span> <span class="va">bm</span>, response <span class="op">=</span> <span class="st">'Ozone'</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="xgboost---gradient-boosting" class="section level3">
<h3 class="hasAnchor">
<a href="#xgboost---gradient-boosting" class="anchor"></a>xgboost - Gradient Boosting</h3>
<p>The <code>xgboost</code> package (short for eXtreme Gradient
Boosting) is an implementation of gradient boosting that supports
regression and classification. As seen in Section
<code>Custom Predict Function</code>, the <code>xgboost</code> package
requires the user to supply a custom predict function to work with
<code>vivid</code>. When setting the <code>data</code> argument in
<code>xgboost</code>, remember to include all the variables (including
the response). When producing the custom predict function, the structure
must match that in the below example. Note that the term
<code>data</code> must be used and not the actual name of the data.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dmlc/xgboost">"xgboost"</a></span><span class="op">)</span></span>
<span><span class="co"># build xgboost model</span></span>
<span><span class="va">gbst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgboost</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">aq</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                label <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">aq</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                nrounds <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># predict function for GBM</span></span>
<span><span class="va">pFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># vivid</span></span>
<span><span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aq</span>, fit <span class="op">=</span> <span class="va">gbst</span>, response <span class="op">=</span> <span class="st">'Ozone'</span>,  predictFun <span class="op">=</span> <span class="va">pFun</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="keras---neural-network" class="section level3">
<h3 class="hasAnchor">
<a href="#keras---neural-network" class="anchor"></a>keras - Neural Network</h3>
<p>The <code>keras</code> package in R is an interface to the original
<code>keras</code> Python library. It allows R users to build and train
neural network models using the high-level Keras API. To use
<code>keras</code> the data must first be normalised. A custom predict
function must be made for use with <code>vivid</code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tensorflow.rstudio.com/">"keras"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalize the data</span></span>
<span><span class="va">normalize_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="op">(</span><span class="va">data</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">aqn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">aq</span>, <span class="va">normalize_data</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Define model architecture</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/keras_model_sequential.html">keras_model_sequential</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">8</span>, activation <span class="op">=</span> <span class="st">'relu'</span>, input_shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">aqn</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># predict function for keras</span></span>
<span><span class="va">pFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># vivid</span></span>
<span><span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aq</span>, fit <span class="op">=</span> <span class="va">model</span>, response <span class="op">=</span> <span class="st">'Ozone'</span>, predictFun <span class="op">=</span> <span class="va">pFun</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="section-9-classification" class="section level2">
<h2 class="hasAnchor">
<a href="#section-9-classification" class="anchor"></a>Section 9: Classification</h2>
<div id="classification-example" class="section level3">
<h3 class="hasAnchor">
<a href="#classification-example" class="anchor"></a>Classification example</h3>
<p>In this section, we briefly describe how to apply the above
visualisations to a classification example using the <code>iris</code>
data set.</p>
<p>To begin we fit a <code>ranger</code> random forest model with
“Species” as the response and create the vivi matrix setting the
category for classification to be “setosa” using <code>class</code>.</p>
</div>
<div id="vivi" class="section level3">
<h3 class="hasAnchor">
<a href="#vivi" class="anchor"></a>vivi</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">rfClassif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ranger/man/ranger.html">ranger</a></span><span class="op">(</span><span class="va">Species</span><span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, probability <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                    importance <span class="op">=</span> <span class="st">"impurity"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">viviClassif</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rfClassif</span>, </span>
<span>                     data <span class="op">=</span> <span class="va">iris</span>, </span>
<span>                     response <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>                     gridSize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                     nmax <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                     reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     class <span class="op">=</span> <span class="st">"setosa"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="heatmap" class="section level3">
<h3 class="hasAnchor">
<a href="#heatmap" class="anchor"></a>Heatmap</h3>
<p>Next we plot the heatmap and network plot of the iris data.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviClassif</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviClassif</span><span class="op">)</span></span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/classifVIVI.png" width="100%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig12:fig12">Figure 12: </span>Heatmap in (a) and Network plot
in (b) of random forest fit on the iris data
</caption>
</center>
</div>
<div id="gpdp" class="section level3">
<h3 class="hasAnchor">
<a href="#gpdp" class="anchor"></a>GPDP</h3>
<p>As mentioned above, as PDPs are evaluated on a grid and can
extrapolate where there is no data. To solve this issue we calculate a
convex hull around the data and remove any points that fall outside the
convex hull, as shown below.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpPairs.html">pdpPairs</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, </span>
<span>         fit <span class="op">=</span> <span class="va">rfClassif</span>, </span>
<span>         response <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>         class <span class="op">=</span> <span class="st">"setosa"</span>,  </span>
<span>         convexHull <span class="op">=</span> <span class="cn">T</span>, </span>
<span>         gridSize <span class="op">=</span> <span class="fl">10</span>, </span>
<span>         nmax <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> </span></code></pre></div>
<img src="https://raw.githubusercontent.com/AlanInglis/vivid/master/vividVigplots/classifGPDP.png" width="80%" style="display: block; margin: auto;"><center>
<caption>
<span id="fig12:fig12">Figure 12: </span>GPDP of random forest fit on
the iris data with extrapolated data removed.
</caption>
</center>
</div>
</div>
<div id="section-10-full-script" class="section level2">
<h2 class="hasAnchor">
<a href="#section-10-full-script" class="anchor"></a>Section 10: Full Script</h2>
<p>This section consolidates the Sections <code>Data and Model</code>,
<code>vivi</code>, <code>Visualisations</code>
<code>Custom Predict Function</code>, and <code>Embedded Vimps</code>
into a single script to facilitate ease of viewing.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://alaninglis.github.io/vivid/">"vivid"</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">"randomForest"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data based on the Friedman equation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">genFriedman</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">noFeatures</span> <span class="op">=</span> <span class="fl">10</span>, <span class="va">noSamples</span> <span class="op">=</span> <span class="fl">100</span>, <span class="va">sigma</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Create dataframe with named columns</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">noSamples</span> <span class="op">*</span> <span class="va">noFeatures</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">noSamples</span><span class="op">)</span>, </span>
<span>                               stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">noFeatures</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Equation: y = 10sin(πx1x2) + 20(x3−0.5)^2 + 10x4 + 5x5 + ε</span></span>
<span>  </span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">pi</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x1</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fl">20</span> <span class="op">*</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x3</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> </span>
<span>    <span class="fl">10</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x4</span> <span class="op">+</span> </span>
<span>    <span class="fl">5</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x5</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">noSamples</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span> <span class="co"># error</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">myData</span> <span class="op">&lt;-</span> <span class="fu">genFriedman</span><span class="op">(</span>noFeatures <span class="op">=</span> <span class="fl">9</span>, noSamples <span class="op">=</span> <span class="fl">350</span>, sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span>
<span></span>
<span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span></span>
<span>  </span>
<span><span class="co"># Fit random forest using randomForest package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">myData</span><span class="op">)</span></span>
<span></span>
<span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span></span>
<span></span>
<span><span class="co"># Run vivid</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">viviRf</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rf</span>, </span>
<span>                data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>                response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                gridSize <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                importanceType <span class="op">=</span> <span class="st">"agnostic"</span>,</span>
<span>                nmax <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                predictFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                numPerm <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                showVimpError <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span></span>
<span></span>
<span><span class="co"># Visualisations:</span></span>
<span>  </span>
<span><span class="co"># 1.0: Heatmap</span></span>
<span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1.1: Heatmap with custom colour palettes and a small border around the diagonal importance values</span></span>
<span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span>,</span>
<span>            intPal <span class="op">=</span> <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/hcl_palettes.html">sequential_hcl</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Oslo"</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>            impPal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/hcl_palettes.html">sequential_hcl</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Reds 3"</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            border <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2.0: Network</span></span>
<span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2.1: Network with interactions below 0.12 are filtered. </span></span>
<span><span class="co"># By default, unconnected nodes are displayed, however, they can be removed by setting `removeNode = T`</span></span>
<span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span>, intThreshold <span class="op">=</span> <span class="fl">0.12</span>, removeNode <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRf</span>, intThreshold <span class="op">=</span> <span class="fl">0.12</span>, removeNode <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2.3: Network clustered and with interactions thresholded</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="co"># clustered and filtered network for rf</span></span>
<span><span class="va">intVals</span> <span class="op">&lt;-</span> <span class="va">viviRf</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">intVals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span> </span>
<span></span>
<span></span>
<span><span class="co"># select VIVI values in top 20%</span></span>
<span><span class="va">impTresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">viviRf</span><span class="op">)</span>,<span class="fl">.8</span><span class="op">)</span></span>
<span><span class="va">intThresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">intVals</span>,<span class="fl">.8</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">viviRf</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">impTresh</span> <span class="op">|</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">intVals</span>, <span class="fl">1</span>, <span class="va">max</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">intThresh</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="va">viviRf</span><span class="op">[</span><span class="va">sv</span>,<span class="va">sv</span><span class="op">]</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"single"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu"><a href="../reference/viviNetwork.html">viviNetwork</a></span><span class="op">(</span><span class="va">viviRf</span><span class="op">[</span><span class="va">sv</span>,<span class="va">sv</span><span class="op">]</span>,</span>
<span>            cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">h</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="co"># specify number of groups</span></span>
<span>            layout <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="va"><a href="https://r.igraph.org/reference/layout_as_star.html">layout_as_star</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3.0: PDP of the top 5 variables extracted from the vivi matrix and number of ICe curves set to 100</span></span>
<span><span class="va">top5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">viviRf</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/pdpVars.html">pdpVars</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>,</span>
<span>        fit <span class="op">=</span> <span class="va">rf</span>,</span>
<span>        response <span class="op">=</span> <span class="st">'y'</span>,</span>
<span>        vars <span class="op">=</span> <span class="va">top5</span>,</span>
<span>        nIce <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4.0: GPDP of the variables x1 to x5, with 100 ICE curves shown. </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpPairs.html">pdpPairs</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>         fit <span class="op">=</span>  <span class="va">rf</span>, </span>
<span>         response <span class="op">=</span> <span class="st">"y"</span>, </span>
<span>         nmax <span class="op">=</span> <span class="fl">500</span>, </span>
<span>         gridSize <span class="op">=</span> <span class="fl">10</span>,         </span>
<span>         vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span><span class="op">)</span>,</span>
<span>         nIce <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5.0: ZPDP of all variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpZen.html">pdpZen</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, fit <span class="op">=</span> <span class="va">rf</span>, response <span class="op">=</span> <span class="st">"y"</span>, nmax <span class="op">=</span> <span class="fl">500</span>, gridSize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5.1: ZPDP where the `zpath` argument specifies the variables to be plotted. In this case, x1 to x5.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpZen.html">pdpZen</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>       fit <span class="op">=</span> <span class="va">rf</span>, </span>
<span>       response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>       nmax <span class="op">=</span> <span class="fl">500</span>, </span>
<span>       gridSize <span class="op">=</span> <span class="fl">10</span>, </span>
<span>       zpath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5.2: ZPDP with the zpaths set with different parameters using the `zPath` function.</span></span>
<span><span class="va">intVals</span> <span class="op">&lt;-</span> <span class="va">viviRf</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">intVals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">intThresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">intVals</span>, <span class="fl">.90</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">zpSw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/zPath.html">zPath</a></span><span class="op">(</span>viv <span class="op">=</span> <span class="va">viviRf</span>, cutoff <span class="op">=</span> <span class="va">intThresh</span>, connect <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">'strictly.weighted'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpZen.html">pdpZen</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>       fit <span class="op">=</span> <span class="va">rf</span>, </span>
<span>       response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>       nmax <span class="op">=</span> <span class="fl">500</span>, </span>
<span>       gridSize <span class="op">=</span> <span class="fl">10</span>, </span>
<span>       zpath <span class="op">=</span> <span class="va">zpSw</span><span class="op">)</span></span></code></pre></div>
<div id="using-a-custom-predict-function" class="section level3">
<h3 class="hasAnchor">
<a href="#using-a-custom-predict-function" class="anchor"></a>Using a custom predict function</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://alaninglis.github.io/vivid/">"vivid"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dmlc/xgboost">"xgboost"</a></span><span class="op">)</span></span>
<span><span class="va">gbst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgboost</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">myData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                label <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">myData</span><span class="op">[</span>,<span class="fl">10</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                nrounds <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># predict function for GBM</span></span>
<span><span class="va">pFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run vivid</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">viviGBst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">gbst</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">myData</span>,</span>
<span>                 response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                 reorder <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 normalized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 predictFun <span class="op">=</span> <span class="va">pFun</span>,</span>
<span>                 gridSize <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                 nmax <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot heatmap</span></span>
<span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviGBst</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="using-embedded-variable-importance" class="section level3">
<h3 class="hasAnchor">
<a href="#using-embedded-variable-importance" class="anchor"></a>Using embedded variable importance</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://alaninglis.github.io/vivid/">"vivid"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">"randomForest"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/imbs-hl/ranger">"ranger"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># randomForest</span></span>
<span><span class="co"># Note importance must be set to TRUE to use embedded importance scores. </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">rfEmbedded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">myData</span>, importance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using % increase in MSE as the importance metric in vivid</span></span>
<span><span class="va">viviRfEmbedded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rfEmbedded</span>, </span>
<span>                       data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>                       response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                       importanceType <span class="op">=</span> <span class="st">"%IncMSE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot Heatmap</span></span>
<span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRfEmbedded</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ranger</span></span>
<span><span class="co"># Note the importance metric is selected directly in ranger</span></span>
<span><span class="va">rang</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ranger/man/ranger.html">ranger</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">myData</span>, importance <span class="op">=</span> <span class="st">'impurity'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run vivid</span></span>
<span><span class="va">viviRangEmbedded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rang</span>, </span>
<span>                         data <span class="op">=</span> <span class="va">myData</span>, </span>
<span>                         response <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                         importanceType <span class="op">=</span> <span class="st">"impurity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot Heatmap</span></span>
<span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviRangEmbedded</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="classification" class="section level3">
<h3 class="hasAnchor">
<a href="#classification" class="anchor"></a>Classification</h3>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://alaninglis.github.io/vivid/">"vivid"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">"randomForest"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="va">rfClassif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ranger/man/ranger.html">ranger</a></span><span class="op">(</span><span class="va">Species</span><span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, probability <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                    importance <span class="op">=</span> <span class="st">"impurity"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">viviClassif</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vivi.html">vivi</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rfClassif</span>, </span>
<span>                     data <span class="op">=</span> <span class="va">iris</span>, </span>
<span>                     response <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>                     gridSize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                     nmax <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                     reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     class <span class="op">=</span> <span class="st">"setosa"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">viviClassif</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1701</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pdpPairs.html">pdpPairs</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, </span>
<span>         fit <span class="op">=</span> <span class="va">rfClassif</span>, </span>
<span>         response <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>         class <span class="op">=</span> <span class="st">"setosa"</span>,  </span>
<span>         convexHull <span class="op">=</span> <span class="cn">T</span>, </span>
<span>         gridSize <span class="op">=</span> <span class="fl">10</span>, </span>
<span>         nmax <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> </span></code></pre></div>
</div>
</div>
<div id="section-11-references" class="section level2">
<h2 class="hasAnchor">
<a href="#section-11-references" class="anchor"></a>Section 11: References</h2>
<ol style="list-style-type: decimal">
<li><p>Alan Inglis and Andrew Parnell and Catherine B. Hurley (2022)
Visualizing Variable Importance and Variable Interaction Effects in
Machine Learning Models. Journal of Computational and Graphical
Statistics (3), pages 1-13</p></li>
<li><p>Breiman, Leo. 2001. “Random Forests.” Machine Learning 45 (1):
5–32. <a href="https://doi.org/10.1023/A" class="uri">https://doi.org/10.1023/A</a>: 1010933404324.</p></li>
<li><p>Friedman, J. H. 2000. “Greedy Function Approximation: A Gradient
Boosting Machine.” The Annals of Statistics 29 (November). <a href="https://doi.org/10.1214/aos/1013203451" class="uri">https://doi.org/10.1214/aos/1013203451</a>.</p></li>
<li><p>Chipman, Hugh A, Edward I George, and Robert E McCulloch. 2010.
“BART: Bayesian Additive Regression Trees.” The Annals of Applied
Statistics 4 (1): 266–98.</p></li>
<li><p>Paluszynska, Aleksandra, Przemyslaw Biecek, and Yue Jiang. 2020.
randomForestExplainer: Explaining and Visualizing Random Forests in
Terms of Variable Importance. <a href="https://CRAN.R-project.org/" class="uri">https://CRAN.R-project.org/</a>
package=randomForestExplainer.</p></li>
<li><p>Ishwaran, Hemant, Udaya B Kogalur, Eiran Z Gorodeski, Andy J
Minn, and Michael S Lauer. 2010. “High-Dimensional Variable Selection
for Survival Data.” Journal of the American Statistical Associa- tion
105 (489): 205–17.</p></li>
<li><p>Probst, Philipp. 2020. varImp: RF Variable Importance for
Arbitrary Measures. <a href="https://CRAN.R-project" class="uri">https://CRAN.R-project</a>. org/package=varImp.</p></li>
<li><p>Strobl, Carolin, Anne-Laure Boulesteix, Thomas Kneib, Thomas
Augustin, and Achim Zeileis. 2008. “Conditional Variable Importance for
Random Forests.” BMC Bioinformatics 9 (307). <a href="https://doi" class="uri">https://doi</a>. org/10.1186/1471-2105-9-307</p></li>
<li><p>Maksymiuk, Szymon, Ewelina Karbowiak, and Przemyslaw Biecek.
2021. EIX: Explain Interactions in ’XGBoost’. <a href="https://CRAN.R-project.org/package=EIX" class="uri">https://CRAN.R-project.org/package=EIX</a>.</p></li>
<li><p>Molnar, Christoph, Bernd Bischl, and Giuseppe Casalicchio. 2018.
“Iml: An r Package for Interpretable Machine Learning.” JOSS 3 (26):
786. <a href="https://doi.org/10.21105/joss.00786" class="uri">https://doi.org/10.21105/joss.00786</a>.</p></li>
<li><p>Mayer M (2023). <em>flashlight: Shed Light on Black Box Machine
Learning Models</em>. R package version 0.9.0, <a href="https://CRAN.R-project.org/package=flashlight" class="uri">https://CRAN.R-project.org/package=flashlight</a>.</p></li>
<li><p>Biecek, Przemyslaw. 2018. “DALEX: Explainers for Complex
Predictive Models in R.” Journal of Machine Learning Research 19 (84):
1–5. <a href="https://jmlr.org/papers/v19/18-416.html" class="uri">https://jmlr.org/papers/v19/18-416.html</a>.</p></li>
<li><p>Greenwell, Brandon M., and Bradley C. Boehmke. 2020. “Variable
Importance Plots—an Introduction to the vip Package.” The R Journal 12
(1): 343–66. <a href="https://doi.org/10.32614/RJ-2020-013" class="uri">https://doi.org/10.32614/RJ-2020-013</a>.</p></li>
<li><p>Fisher A., Rudin C., Dominici F. (2018). All Models are Wrong but
many are Useful: Variable Importance for Black-Box, Proprietary, or
Misspecified Prediction Models, using Model Class Reliance.
Arxiv.</p></li>
<li><p>Marvin N. Wright, Andreas Ziegler (2017). ranger: A Fast
Implementation of Random Forests for High Dimensional Data in C++ and R.
Journal of Statistical Software, 77(1), 1-17. <a href="doi:10.18637/jss.v077.i01" class="uri">doi:10.18637/jss.v077.i01</a>], randomForest^[A. Liaw and M.
Wiener (2002). Classification and Regression by randomForest. R News
2(3), 18–22.</p></li>
<li><p>Bischl B, Lang M, Kotthoff L, Schiffner J, Richter J, Studerus E,
Casalicchio G, Jones Z (2016). “mlr: Machine Learning in R.” <em>Journal
of Machine Learning Research</em>, <em>17</em>(170), 1-5. <a href="https://jmlr.org/papers/v17/15-066.html" class="uri">https://jmlr.org/papers/v17/15-066.html</a>.</p></li>
<li><p>Lang M, Binder M, Richter J, Schratz P, Pfisterer F, Coors S, Au
Q, Casalicchio G, Kotthoff L, Bischl B (2019). “mlr3: A modern
object-oriented machine learning framework in R.” <em>Journal of Open
Source Software</em>. <a href="doi:10.21105/joss.01903" class="uri">doi:10.21105/joss.01903</a></p></li>
<li><p>Kuhn M, Vaughan D (2023). <em>parsnip: A Common API to Modeling
and Analysis Functions</em>. R package version 1.1.1, <a href="https://CRAN.R-project.org/package=parsnip" class="uri">https://CRAN.R-project.org/package=parsnip</a>.</p></li>
<li><p>Friedman, J. H. 2000. “Greedy Function Approximation: A Gradient
Boosting Machine.” The Annals of Statistics 29 (November). <a href="https://doi.org/10.1214/aos/1013203451" class="uri">https://doi.org/10.1214/aos/1013203451</a>.</p></li>
<li><p>Goldstein, Alex, Adam Kapelner, Justin Bleich, and Emil Pitkin.
2015. “Peeking Inside the Black Box: Visualizing Statistical Learning
with Plots of Individual Conditional Expectation.” Journal of
Computational and Graphical Statistics 24 (1): 44–65. <a href="https://doi.org/10.1080/10618600.2014" class="uri">https://doi.org/10.1080/10618600.2014</a>. 907095.</p></li>
<li><p>Greenwell, Brandon M. 2017. “pdp: An r Package for Constructing
Partial Dependence Plots.” The R Journal 9 (1): 421–36. <a href="https://journal.r-project.org/archive/2017/RJ-2017-016/index.html" class="uri">https://journal.r-project.org/archive/2017/RJ-2017-016/index.html</a>.</p></li>
<li><p>Friedman, J. H. and Popescu, B. E. (2008). “Predictive learning
via rule ensembles.” The Annals of Applied Statistics. JSTOR,
916–54.</p></li>
<li><p>Friedman, Jerome H. (1991) Multivariate adaptive regression
splines. The Annals of Statistics 19 (1), pages 1-67.</p></li>
<li><p>Zeileis, Achim, Jason C. Fisher, Kurt Hornik, Ross Ihaka, Claire
D. McWhite, Paul Murrell, Reto Stauffer, and Claus O. Wilke. 2020.
“Colorspace: A Toolbox for Manipulating and Assessing Colors and
Palettes.” Journal of Statistical Software, Articles 96 (1):
1–49</p></li>
<li><p>Hierholzer, Carl, and Chr Wiener. 1873. “Über Die möglichkeit,
Einen Linienzug Ohne Wiederholung Und Ohne Unterbrechung Zu Umfahren.”
Mathematische Annalen 6 (1): 30–32.</p></li>
<li><p>Hofert, Marius, and Wayne Oldford. 2020. “Zigzag Expanded
Navigation Plots in R: The R Package zenplots.” Journal of Statistical
Software 95 (4): 1–44.</p></li>
<li><p>Hurley, Catherine, Mark OConnell, and Katarina Domijan. 2022.
Condvis2: Interactive Conditional Visualization for Supervised and
Unsupervised Models in Shiny.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alan Inglis, Andrew Parnell, Catherine Hurley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
