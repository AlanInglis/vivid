<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>vivi — vivi • vivid</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="vivi — vivi"><meta property="og:description" content="Creates a matrix displaying variable importance on the diagonal
and variable interaction on the off-diagonal."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vivid</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/bartMachineVivid.html">bartMachine - BART</a>
    </li>
    <li>
      <a href="../articles/caretVivid.html">caret - Neural Network</a>
    </li>
    <li>
      <a href="../articles/gbmVivid.html">gbm - Generalized Boosted Model</a>
    </li>
    <li>
      <a href="../articles/kerasVivid.html">keras - Neural Network</a>
    </li>
    <li>
      <a href="../articles/mlrVivid.html">mlr3 - k-nearest Neighbours</a>
    </li>
    <li>
      <a href="../articles/randomForestVivid.html">randomForest - Random Forest</a>
    </li>
    <li>
      <a href="../articles/rangerVivid.html">ranger - Random Forest</a>
    </li>
    <li>
      <a href="../articles/svmVivid.html">e1071 - Support Vector Machine</a>
    </li>
    <li>
      <a href="../articles/vividVignette.html">vivid: Variable Importance and Variable Interaction Displays</a>
    </li>
    <li>
      <a href="../articles/xgbVivid.html">xgboost - Gradient Boosting</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>vivi</h1>

    <div class="hidden name"><code>vivi.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a matrix displaying variable importance on the diagonal
and variable interaction on the off-diagonal.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vivi</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">fit</span>,</span>
<span>  <span class="va">response</span>,</span>
<span>  gridSize <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  importanceType <span class="op">=</span> <span class="st">"agnostic"</span>,</span>
<span>  nmax <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  class <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  predictFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  numPerm <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  showVimpError <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  vars <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame used for fit.</p></dd>


<dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>A supervised machine learning model, which understands condvis2::CVpredict</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>The name of the response for the fit.</p></dd>


<dt id="arg-gridsize">gridSize<a class="anchor" aria-label="anchor" href="#arg-gridsize"></a></dt>
<dd><p>The size of the grid for evaluating the predictions.</p></dd>


<dt id="arg-importancetype">importanceType<a class="anchor" aria-label="anchor" href="#arg-importancetype"></a></dt>
<dd><p>Used to select the importance metric. By default, an agnostic importance
measure is used. If an embedded metric is available, then setting this argument
to the importance metric will use the selected importance values in the vivid-matrix.
Please refer to the examples given for illustration.
Alternatively, set to equal "agnostic" (the default) to override embedded importance measures and
return agnostic importance values.</p></dd>


<dt id="arg-nmax">nmax<a class="anchor" aria-label="anchor" href="#arg-nmax"></a></dt>
<dd><p>Maximum number of data rows to consider. Default is 500. Use all rows if NULL.</p></dd>


<dt id="arg-reorder">reorder<a class="anchor" aria-label="anchor" href="#arg-reorder"></a></dt>
<dd><p>If TRUE (default) uses DendSer to reorder the matrix of interactions and variable importances.</p></dd>


<dt id="arg-class">class<a class="anchor" aria-label="anchor" href="#arg-class"></a></dt>
<dd><p>Category for classification, a factor level, or a number indicating which factor level.</p></dd>


<dt id="arg-predictfun">predictFun<a class="anchor" aria-label="anchor" href="#arg-predictfun"></a></dt>
<dd><p>Function of (fit, data) to extract numeric predictions from fit. Uses condvis2::CVpredict by default, which works for many fit classes.</p></dd>


<dt id="arg-normalized">normalized<a class="anchor" aria-label="anchor" href="#arg-normalized"></a></dt>
<dd><p>Should Friedman's H-statistic be normalized or not. Default is FALSE.</p></dd>


<dt id="arg-numperm">numPerm<a class="anchor" aria-label="anchor" href="#arg-numperm"></a></dt>
<dd><p>Number of permutations to perform for agnostic importance. Default is 4.</p></dd>


<dt id="arg-showvimperror">showVimpError<a class="anchor" aria-label="anchor" href="#arg-showvimperror"></a></dt>
<dd><p>Logical. If TRUE, and <code>numPerm &gt; 1</code> then a tibble containing the variable names, their importance values,
and the standard error for each importance is printed to the console.</p></dd>


<dt id="arg-vars">vars<a class="anchor" aria-label="anchor" href="#arg-vars"></a></dt>
<dd><p>A vector of variable names to be assessed.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A matrix of interaction values, with importance on the diagonal.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>If the argument <code>importanceType = 'agnostic'</code>, then an agnostic permutation importance (1) is calculated.
Friedman's H statistic (2) is used for measuring the interactions. This measure is based on partial dependence curves
and relates the interaction strength of a pair of variables to the total effect strength of that variable pair.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>1: Fisher A., Rudin C., Dominici F. (2018). All Models are Wrong but many are Useful: Variable Importance for Black-Box, Proprietary, or Misspecified Prediction Models, using Model Class Reliance. Arxiv.</p>
<p>2: Friedman, J. H. and Popescu, B. E. (2008). “Predictive learning via rule ensembles.” The Annals of Applied Statistics. JSTOR, 916–54.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">aq</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">vivi</span><span class="op">(</span>fit <span class="op">=</span> <span class="va">f</span>, data <span class="op">=</span> <span class="va">aq</span>, response <span class="op">=</span> <span class="st">"Ozone"</span><span class="op">)</span> <span class="co"># as expected all interactions are zero</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Agnostic variable importance method used.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating interactions...</span>
<span class="r-in"><span><span class="fu"><a href="viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="vivi-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select importance metric</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/" class="external-link">randomForest</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> randomForest 4.7-1.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Type rfNews() to see new features/changes/bug fixes.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘randomForest’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:ranger’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     importance</span>
<span class="r-in"><span><span class="va">rf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">aq</span>, importance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">vivi</span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rf1</span>, data <span class="op">=</span> <span class="va">aq</span>, response <span class="op">=</span> <span class="st">'Ozone'</span>,</span></span>
<span class="r-in"><span>           importanceType <span class="op">=</span> <span class="st">'%IncMSE'</span><span class="op">)</span> <span class="co"># select %IncMSE as the importance measure</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> %IncMSE importance selected.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating interactions...</span>
<span class="r-in"><span><span class="fu"><a href="viviHeatmap.html">viviHeatmap</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="vivi-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://imbs-hl.github.io/ranger/" class="external-link">ranger</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://imbs-hl.github.io/ranger/reference/ranger.html" class="external-link">ranger</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, importance <span class="op">=</span> <span class="st">"impurity"</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">vivi</span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rf</span>, data <span class="op">=</span> <span class="va">iris</span>, response <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span> <span class="co"># returns agnostic importance</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Agnostic variable importance method used.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating interactions...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Petal.Width Petal.Length Sepal.Length Sepal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Width    0.3033834    6.9383895   6.98670954  4.43540679</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length   6.9383895    0.3319385   7.05215391  4.44279137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Length   6.9867095    7.0521539   0.02111516  3.60983578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width    4.4354068    4.4427914   3.60983578  0.01200073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "vivid"  "matrix" "array" </span>
<span class="r-in"><span><span class="fu">vivi</span><span class="op">(</span>fit <span class="op">=</span> <span class="va">rf</span>, data <span class="op">=</span> <span class="va">iris</span>, response <span class="op">=</span> <span class="st">"Species"</span>,</span></span>
<span class="r-in"><span>     importanceType <span class="op">=</span> <span class="st">"impurity"</span><span class="op">)</span> <span class="co"># returns selected 'impurity' importance.</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Embedded impurity variable importance method used.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating interactions...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Petal.Width Petal.Length Sepal.Length Sepal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Width    42.786822     7.145377     7.206707    4.463222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length    7.145377    43.144629     7.269573    4.469643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Length    7.206707     7.269573     8.637146    3.662476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width     4.463222     4.469643     3.662476    1.169145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "vivid"  "matrix" "array" </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alan Inglis, Andrew Parnell, Catherine Hurley.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

